(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,47582,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(42023),i=e.i(66027),n=e.i(54616),l=e.i(84923),r=e.i(58260),d=e.i(6625),c=e.i(4766),m=e.i(38785),o=e.i(37014),x=e.i(92590),u=e.i(90639),p=e.i(84589),h=e.i(38263),j=e.i(32076),g=e.i(71689),v=e.i(63488),f=e.i(96112),N=e.i(75254);let b=(0,N.default)("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);var y=e.i(63209),w=e.i(98962),C=e.i(31343),k=e.i(95242),R=e.i(39616),T=e.i(86536),S=e.i(64659),A=e.i(27612),D=e.i(39312);let M=(0,N.default)("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]);var E=e.i(16715),B=e.i(43531),q=e.i(37727),_=e.i(45919),I=e.i(52301),F=e.i(14764),P=e.i(3116);let O=(0,N.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);function U({steps:e,totalRecipients:t,className:a}){let i=({value:e,rate:t,label:a,icon:i,iconColor:n})=>(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center p-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground mb-1",children:[(0,s.jsx)(i,{className:(0,I.cn)("h-3 w-3",n)}),(0,s.jsx)("span",{children:a})]}),(0,s.jsx)("div",{className:"text-lg font-semibold",children:e}),void 0!==t&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[t,"%"]})]});return(0,s.jsxs)(c.Card,{className:(0,I.cn)("",a),children:[(0,s.jsx)(c.CardHeader,{children:(0,s.jsxs)(c.CardTitle,{className:"text-lg flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Campaign Progress"}),(0,s.jsxs)(m.Badge,{variant:"outline",className:"font-normal",children:[t," recipients"]})]})}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-2 pb-2 border-b",children:[(0,s.jsx)("div",{className:"col-span-2"}),(0,s.jsx)("div",{className:"text-center text-sm font-medium text-muted-foreground",children:"Sent"}),(0,s.jsx)("div",{className:"text-center text-sm font-medium text-muted-foreground",children:"Opens"}),(0,s.jsx)("div",{className:"text-center text-sm font-medium text-muted-foreground",children:"Clicks"}),(0,s.jsx)("div",{className:"text-center text-sm font-medium text-muted-foreground",children:"Replies"}),(0,s.jsx)("div",{className:"text-center text-sm font-medium text-muted-foreground",children:"Unsubscribes"})]}),e.map(e=>(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-2 items-center",children:[(0,s.jsxs)("div",{className:"col-span-2 space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(e=>{switch(e){case"completed":return(0,s.jsx)(O,{className:"h-4 w-4 text-green-500"});case"in_progress":return(0,s.jsx)(P.Clock,{className:"h-4 w-4 text-blue-500 animate-pulse"});case"pending":return(0,s.jsx)(P.Clock,{className:"h-4 w-4 text-gray-400"})}})(e.status),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-medium text-sm",children:["Step ",e.stepNumber]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:e.name})]})]}),e.condition&&(0,s.jsx)("div",{className:"text-xs text-muted-foreground ml-6",children:e.condition}),e.triggeredAt&&(0,s.jsx)("div",{className:"text-xs text-muted-foreground ml-6",children:(0,_.format)(new Date(e.triggeredAt),"MMM d, h:mm a")})]}),(0,s.jsx)(i,{value:e.sent,label:"",icon:F.Send,iconColor:"text-gray-500"}),(0,s.jsx)(i,{value:e.opens,rate:e.openRate,label:"",icon:T.Eye,iconColor:"text-yellow-500"}),(0,s.jsx)(i,{value:e.clicks,rate:e.clickRate,label:"",icon:f.MousePointer,iconColor:"text-green-500"}),(0,s.jsx)(i,{value:e.replies,rate:e.replyRate,label:"",icon:b,iconColor:"text-blue-500"}),(0,s.jsx)(i,{value:e.unsubscribes,rate:e.unsubscribeRate,label:"",icon:w.UserX,iconColor:"text-red-500"})]}),"in_progress"===e.status&&e.sent<t&&(0,s.jsx)("div",{className:"ml-6 mr-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Progress,{value:e.sent/t*100,className:"flex-1 h-1.5"}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[(e.sent/t*100).toFixed(0),"%"]})]})})]},e.stepNumber)),0===e.length&&(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(P.Clock,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),(0,s.jsx)("p",{className:"text-sm",children:"Campaign not started yet"})]})]})})]})}var L=e.i(13853);let H=({recipients:e,showError:t=!1,errorMessage:a})=>{let i=e=>e?(0,_.format)(new Date(e),"MMM d, h:mm a"):"-";return 0===e.length?(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(v.Mail,{className:"h-8 w-8 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No recipients found"})]}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full border-collapse",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("th",{className:"text-left p-3 font-medium",children:"Recipient"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium",children:"Company"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium",children:"Status"}),(0,s.jsx)("th",{className:"text-left p-3 font-medium",children:"Events"}),t&&(0,s.jsx)("th",{className:"text-left p-3 font-medium",children:"Error"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"border-b hover:bg-muted/30 transition-colors",children:[(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-medium",children:[e.firstName," ",e.lastName]}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.email})]})}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsx)("span",{className:"text-sm",children:e.companyName})}),(0,s.jsx)("td",{className:"p-3",children:(e=>{if(e.repliedAt)return(0,s.jsx)(m.Badge,{className:"bg-blue-500 text-white",children:"Replied"});if(e.clickedAt)return(0,s.jsx)(m.Badge,{className:"bg-green-500 text-white",children:"Clicked"});if(e.openedAt)return(0,s.jsx)(m.Badge,{className:"bg-yellow-500 text-white",children:"Opened"});if(e.bouncedAt)return(0,s.jsx)(m.Badge,{variant:"destructive",children:"Bounced"});if(e.unsubscribedAt)return(0,s.jsx)(m.Badge,{variant:"secondary",children:"Unsubscribed"});if(e.sentAt)return(0,s.jsx)(m.Badge,{variant:"outline",children:"Sent"});switch(e.status){case"queued":case"scheduled":return(0,s.jsx)(m.Badge,{variant:"secondary",children:"Queued"});case"sent":return(0,s.jsx)(m.Badge,{variant:"outline",children:"Sent"});case"manual_send_required":return(0,s.jsx)(m.Badge,{className:"bg-yellow-500 text-white",children:"Manual Send Required"});case"failed_generation":return(0,s.jsx)(m.Badge,{variant:"destructive",children:"Failed Generation"});case"failed_send":return(0,s.jsx)(m.Badge,{variant:"destructive",children:"Failed Send"});case"in_review":return(0,s.jsx)(m.Badge,{children:"In Review"});default:return(0,s.jsx)(m.Badge,{variant:"secondary",children:"Pending"})}})(e)}),(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)("div",{className:"text-sm space-y-1",children:[e.sentAt&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(v.Mail,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Sent: ",i(e.sentAt)]})]}),e.openedAt&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-yellow-600 dark:text-yellow-400",children:[(0,s.jsx)(T.Eye,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Opened: ",i(e.openedAt)]})]}),e.clickedAt&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:[(0,s.jsx)(f.MousePointer,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Clicked: ",i(e.clickedAt)]})]}),e.repliedAt&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-blue-600 dark:text-blue-400",children:[(0,s.jsx)(b,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Replied: ",i(e.repliedAt)]})]}),e.bouncedAt&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-red-600 dark:text-red-400",children:[(0,s.jsx)(y.AlertCircle,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Bounced: ",i(e.bouncedAt)]})]}),e.unsubscribedAt&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-gray-600 dark:text-gray-400",children:[(0,s.jsx)(w.UserX,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Unsubscribed: ",i(e.unsubscribedAt)]})]}),!e.sentAt&&!e.openedAt&&!e.clickedAt&&!e.repliedAt&&!e.bouncedAt&&!e.unsubscribedAt&&(0,s.jsx)("span",{className:"text-muted-foreground",children:"No activity yet"})]})}),t&&(0,s.jsx)("td",{className:"p-3",children:"failed_generation"===e.status||"failed_send"===e.status?(0,s.jsx)("span",{className:"text-sm text-red-600 dark:text-red-400",children:"failed_generation"===e.status?"Generation failed":"Send failed"}):(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"-"})})]},e.id))})]})})};function $(){var e;let N,F,P=(0,a.useParams)().id,O=useRouter(),{toast:$}=(0,r.useToast)(),[z,Q]=(0,t.useState)(!1),[G,K]=(0,t.useState)(!1),[X,V]=(0,t.useState)(!1),[Y,J]=(0,t.useState)("failed"),[W,Z]=(0,t.useState)(new Date),{data:ee,isLoading:es,error:et,refetch:ea}=(0,i.useQuery)({queryKey:["/api/campaigns",P],enabled:!!P,refetchOnWindowFocus:!1});(0,t.useEffect)(()=>{if(!P)return;let e=null,s=()=>{e&&clearInterval(e),e=setInterval(()=>{"visible"===document.visibilityState&&(console.log("Auto-refreshing campaign data..."),ea(),Z(new Date))},2e4)},t=()=>{"visible"===document.visibilityState?(console.log("Page became visible, refreshing campaign data"),ea(),Z(new Date),s()):(console.log("Page became hidden, pausing auto-refresh"),e&&(clearInterval(e),e=null))};return"visible"===document.visibilityState&&s(),document.addEventListener("visibilitychange",t),()=>{e&&clearInterval(e),document.removeEventListener("visibilitychange",t)}},[P,ea,Z]);let ei=(0,n.useMutation)({mutationFn:async e=>(0,l.apiRequest)("PUT",`/api/campaigns/${P}`,e),onSuccess:()=>{l.queryClient.invalidateQueries({queryKey:["/api/campaigns"]}),$({title:"Campaign updated",description:"Your campaign has been updated successfully."})},onError:e=>{$({title:"Error",description:e.message||"Failed to update campaign",variant:"destructive"})}}),en=(0,n.useMutation)({mutationFn:async()=>(0,l.apiRequest)("DELETE",`/api/campaigns/${P}`),onSuccess:()=>{$({title:"Campaign deleted",description:"Your campaign has been deleted successfully."}),O.push("/campaigns")},onError:e=>{$({title:"Error",description:e.message||"Failed to delete campaign",variant:"destructive"})}}),el=(0,n.useMutation)({mutationFn:async e=>(0,l.apiRequest)("POST",`/api/campaigns/${P}/restart`,{mode:e}),onSuccess:(e,s)=>{l.queryClient.invalidateQueries({queryKey:["/api/campaigns"]}),l.queryClient.invalidateQueries({queryKey:["/api/campaigns",P]}),V(!1),$({title:"Campaign restarted",description:"all"===s?"The campaign will re-send to all recipients.":"The campaign will queue failed recipients for retry."})},onError:e=>{$({title:"Error",description:e.message||"Failed to restart campaign",variant:"destructive"})}}),er=async(e,s)=>{try{await (0,l.apiRequest)("POST",`/api/campaigns/${e}/review/approve`,{recipientIds:s}),l.queryClient.invalidateQueries({queryKey:["/api/campaigns",e]}),$({title:"Emails approved",description:`${s.length} emails approved for sending`})}catch(e){$({title:"Error",description:"Failed to approve emails",variant:"destructive"})}},ed=async(e,s)=>{try{await (0,l.apiRequest)("POST",`/api/campaigns/${e}/review/reject`,{recipientIds:s}),l.queryClient.invalidateQueries({queryKey:["/api/campaigns",e]}),$({title:"Emails rejected",description:`${s.length} emails will be regenerated`})}catch(e){$({title:"Error",description:"Failed to reject emails",variant:"destructive"})}},ec=async(e,s)=>{await er(e,[s])},em=async(e,s)=>{await ed(e,[s])},eo=async e=>{try{await (0,l.apiRequest)(`/api/campaigns/${e}/retry-failed`,"POST"),l.queryClient.invalidateQueries({queryKey:["/api/campaigns",e]}),$({title:"Retrying failed emails",description:"Failed emails are being retried"})}catch(e){$({title:"Error",description:"Failed to retry emails",variant:"destructive"})}},ex=async e=>{switch(e){case"pause":ei.mutate({status:"paused"});break;case"resume":case"activate":ei.mutate({status:"active"});break;case"stop":confirm("Are you sure you want to stop this campaign? This will permanently halt all sending.")&&ei.mutate({status:"completed"});break;case"restart":V(!0);break;case"edit":Q(!0),$({title:"Edit mode",description:"You can now edit the campaign settings."});break;case"delete":confirm("Are you sure you want to delete this campaign? This action cannot be undone.")&&en.mutate()}};if(es)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading campaign details..."})]})});if(et||!ee)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(y.AlertCircle,{className:"mx-auto h-12 w-12 text-destructive"}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"Campaign not found"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"The campaign you're looking for doesn't exist or has been deleted."}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(a.Link,{href:"/campaigns",children:(0,s.jsxs)(d.Button,{variant:"outline",children:[(0,s.jsx)(g.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to campaigns"]})})})]})});let eu=({icon:e,label:t,value:a,percentage:i,color:n="text-foreground"})=>(0,s.jsxs)("div",{className:"flex flex-col items-center p-4 rounded-lg bg-muted/30",children:[(0,s.jsx)(e,{className:(0,I.cn)("h-8 w-8 mb-2",n)}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:t}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:a}),void 0!==i&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[i.toFixed(1),"%"]})]});return(0,s.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(a.Link,{href:"/campaigns",children:(0,s.jsx)(d.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(g.ArrowLeft,{className:"h-4 w-4"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:ee.name}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[ee.createdAt&&(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Created ",(0,_.format)(new Date(ee.createdAt),"MMM d, yyyy")]}),ee.startDate&&(0,s.jsxs)(s.Fragment,{children:[ee.createdAt&&(0,s.jsx)("span",{className:"text-muted-foreground",children:"•"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["completed"===ee.status?"Ended":"Started"," ",(0,_.format)(new Date(ee.startDate),"MMM d, yyyy")]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(e=ee.status,F=(N={draft:{label:"Draft",variant:"secondary",className:""},scheduled:{label:"Scheduled",variant:"default",className:""},active:{label:"Active",variant:"default",className:"bg-green-500 hover:bg-green-600"},paused:{label:"Paused",variant:"secondary",className:"bg-yellow-500 hover:bg-yellow-600"},stopped:{label:"Stopped",variant:"destructive",className:""},completed:{label:"Completed",variant:"secondary",className:""},cancelled:{label:"Cancelled",variant:"destructive",className:""}})[e]||N.draft,(0,s.jsx)(m.Badge,{variant:F.variant,className:(0,I.cn)(F.className),children:F.label})),(0,s.jsxs)(u.DropdownMenu,{children:[(0,s.jsx)(u.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(d.Button,{variant:"outline","data-testid":"button-campaign-actions",children:["Actions",(0,s.jsx)(S.ChevronDown,{className:"h-4 w-4 ml-2"})]})}),(0,s.jsxs)(u.DropdownMenuContent,{align:"end",className:"w-48",children:["active"===ee.status?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(u.DropdownMenuItem,{onClick:()=>ex("pause"),className:"text-orange-600 dark:text-orange-400","data-testid":"menu-pause-campaign",children:[(0,s.jsx)(k.Pause,{className:"h-4 w-4 mr-2"}),"Pause Campaign"]}),(0,s.jsxs)(u.DropdownMenuItem,{onClick:()=>ex("stop"),className:"text-red-600 dark:text-red-400","data-testid":"menu-stop-campaign",children:[(0,s.jsx)(M,{className:"h-4 w-4 mr-2"}),"Stop Campaign"]})]}):"paused"===ee.status?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(u.DropdownMenuItem,{onClick:()=>ex("resume"),className:"text-green-600 dark:text-green-400","data-testid":"menu-resume-campaign",children:[(0,s.jsx)(C.Play,{className:"h-4 w-4 mr-2"}),"Resume Campaign"]}),(0,s.jsxs)(u.DropdownMenuItem,{onClick:()=>ex("stop"),className:"text-red-600 dark:text-red-400","data-testid":"menu-stop-campaign",children:[(0,s.jsx)(M,{className:"h-4 w-4 mr-2"}),"Stop Campaign"]})]}):"stopped"===ee.status||"completed"===ee.status?(0,s.jsxs)(u.DropdownMenuItem,{onClick:()=>ex("restart"),className:"text-blue-600 dark:text-blue-400","data-testid":"menu-restart-campaign",children:[(0,s.jsx)(E.RefreshCw,{className:"h-4 w-4 mr-2"}),"Restart Campaign"]}):null,(0,s.jsxs)(u.DropdownMenuItem,{onClick:()=>ex("edit"),"data-testid":"menu-edit-campaign",children:[(0,s.jsx)(R.Settings,{className:"h-4 w-4 mr-2"}),"Edit Settings"]}),"draft"===ee.status&&(0,s.jsxs)(u.DropdownMenuItem,{onClick:()=>ex("activate"),className:"text-blue-600 dark:text-blue-400","data-testid":"menu-activate-campaign",children:[(0,s.jsx)(D.Zap,{className:"h-4 w-4 mr-2"}),"Activate Campaign"]}),(0,s.jsx)(u.DropdownMenuSeparator,{}),(0,s.jsxs)(u.DropdownMenuItem,{onClick:()=>ex("delete"),className:"text-red-600 dark:text-red-400","data-testid":"menu-delete-campaign",children:[(0,s.jsx)(A.Trash2,{className:"h-4 w-4 mr-2"}),"Delete Campaign"]})]})]})]})]}),"draft"!==ee.status&&(0,s.jsx)(U,{steps:[{stepNumber:1,name:"Initial Email",description:"Sent at campaign creation",sent:ee.emailsSent,opens:ee.emailsOpened,openRate:ee.openRate||0,clicks:ee.emailsClicked,clickRate:ee.clickRate||0,replies:ee.emailsReplied,replyRate:ee.replyRate||0,unsubscribes:ee.emailsUnsubscribed,unsubscribeRate:ee.unsubscribeRate||0,triggeredAt:ee.startDate?new Date(ee.startDate):void 0,status:ee.emailsSent===ee.totalRecipients?"completed":"active"===ee.status?"in_progress":"pending"}],totalRecipients:ee.totalRecipients}),(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsxs)(c.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(T.Eye,{className:"h-5 w-5"}),"Overview"]}),(0,s.jsx)(c.CardDescription,{children:"Campaign performance at a glance"})]}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,s.jsx)(eu,{icon:v.Mail,label:"Emails sent",value:ee.emailsSent,color:"text-pink-500"}),(0,s.jsx)(eu,{icon:T.Eye,label:"Opens",value:ee.emailsOpened,percentage:ee.openRate,color:"text-yellow-500"}),(0,s.jsx)(eu,{icon:f.MousePointer,label:"Clicks",value:ee.emailsClicked,percentage:ee.clickRate,color:"text-green-500"}),(0,s.jsx)(eu,{icon:b,label:"Replied",value:ee.emailsReplied,percentage:ee.replyRate,color:"text-blue-500"}),(0,s.jsx)(eu,{icon:y.AlertCircle,label:"Bounces",value:ee.emailsBounced,percentage:ee.bounceRate,color:"text-red-500"}),(0,s.jsx)(eu,{icon:w.UserX,label:"Unsubscribes",value:ee.emailsUnsubscribed,percentage:ee.unsubscribeRate,color:"text-gray-500"})]})})]}),(0,s.jsxs)(x.Tabs,{defaultValue:"details",className:"space-y-4",children:[(0,s.jsxs)(x.TabsList,{children:[(0,s.jsx)(x.TabsTrigger,{value:"details",children:"Campaign Details"}),(0,s.jsxs)(x.TabsTrigger,{value:"recipients",children:["Recipients (",ee.totalRecipients,")"]}),(0,s.jsxs)(x.TabsTrigger,{value:"review",children:["Review Queue ",ee.reviewCount&&ee.reviewCount>0&&`(${ee.reviewCount})`]}),(0,s.jsx)(x.TabsTrigger,{value:"activity",children:"Activity Timeline"})]}),(0,s.jsx)(x.TabsContent,{value:"details",className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)(c.Card,{children:[(0,s.jsx)(c.CardHeader,{children:(0,s.jsx)(c.CardTitle,{className:"text-lg",children:"Campaign Settings"})}),(0,s.jsxs)(c.CardContent,{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Contact List"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:ee.contactListName||"Not specified"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total recipients"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:ee.totalRecipients})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Sending progress"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Progress,{value:ee.emailsSent/ee.totalRecipients*100,className:"w-24 h-2"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:[(ee.emailsSent/ee.totalRecipients*100).toFixed(0),"%"]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Generation type"}),(0,s.jsx)(m.Badge,{variant:"outline",children:"ai_unique"===ee.generationType?"AI Unique":"Template"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Human review"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:ee.requiresHumanReview?"Enabled":"Disabled"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Tracking"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:ee.trackEmails?"Enabled":"Disabled"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Unsubscribe link"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:ee.unsubscribeLink?"Enabled":"Disabled"})]}),ee.startDate&&(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Start date/time"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:(0,_.format)(new Date(ee.startDate),"MMM d, yyyy h:mm a")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Autopilot"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:ee.autopilotEnabled?"Enabled":"Disabled"})]}),ee.autopilotEnabled&&ee.autopilotSettings&&(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Sending schedule"}),(0,s.jsx)(d.Button,{variant:"link",size:"sm",className:"h-auto p-0 text-sm font-medium",onClick:()=>K(!0),children:"View Schedule"})]}),ee.autopilotEnabled&&ee.timezone&&(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Timezone"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:ee.timezone})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Daily cap"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:["Max ",ee.maxEmailsPerDay||20," emails/day"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Email delay"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:[ee.delayBetweenEmails||0," ",1===ee.delayBetweenEmails?"minute":"minutes"," between emails"]})]})]})]}),(0,s.jsxs)(c.Card,{children:[(0,s.jsx)(c.CardHeader,{children:(0,s.jsx)(c.CardTitle,{className:"text-lg",children:"Email Template"})}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Subject"}),(0,s.jsx)("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:ee.emailSubject||"No subject set"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Body Preview"}),(0,s.jsx)("div",{className:"text-sm p-2 bg-muted rounded max-h-48 overflow-y-auto whitespace-pre-wrap",children:ee.emailBody?ee.emailBody.substring(0,300)+(ee.emailBody.length>300?"...":""):"No email body set"})]})]})})]})]})}),(0,s.jsx)(x.TabsContent,{value:"recipients",children:(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsx)(c.CardTitle,{children:"Campaign Recipients"}),(0,s.jsx)(c.CardDescription,{children:"Track engagement for each recipient"})]}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)(x.Tabs,{defaultValue:"all",className:"mb-4",children:[(0,s.jsxs)(x.TabsList,{className:"grid w-full grid-cols-6",children:[(0,s.jsxs)(x.TabsTrigger,{value:"all",children:["All (",ee.recipients?.length||0,")"]}),(0,s.jsxs)(x.TabsTrigger,{value:"queued",children:["Queued (",ee.recipients?.filter(e=>"queued"===e.status||"scheduled"===e.status).length||0,")"]}),(0,s.jsxs)(x.TabsTrigger,{value:"sent",children:["Sent (",ee.recipients?.filter(e=>"sent"===e.status).length||0,")"]}),(0,s.jsxs)(x.TabsTrigger,{value:"manual",children:["Manual (",ee.recipients?.filter(e=>"manual_send_required"===e.status).length||0,")"]}),(0,s.jsxs)(x.TabsTrigger,{value:"engaged",children:["Engaged (",ee.recipients?.filter(e=>e.openedAt||e.clickedAt||e.repliedAt).length||0,")"]}),(0,s.jsxs)(x.TabsTrigger,{value:"failed",children:["Failed (",ee.recipients?.filter(e=>"failed_generation"===e.status||"failed_send"===e.status).length||0,")"]})]}),(0,s.jsx)(x.TabsContent,{value:"all",className:"mt-4",children:(0,s.jsx)(H,{recipients:ee.recipients||[]})}),(0,s.jsx)(x.TabsContent,{value:"queued",className:"mt-4",children:(0,s.jsx)(H,{recipients:ee.recipients?.filter(e=>"queued"===e.status||"scheduled"===e.status)||[]})}),(0,s.jsx)(x.TabsContent,{value:"sent",className:"mt-4",children:(0,s.jsx)(H,{recipients:ee.recipients?.filter(e=>"sent"===e.status)||[]})}),(0,s.jsx)(x.TabsContent,{value:"engaged",className:"mt-4",children:(0,s.jsx)(H,{recipients:ee.recipients?.filter(e=>e.openedAt||e.clickedAt||e.repliedAt)||[]})}),(0,s.jsx)(x.TabsContent,{value:"manual",className:"mt-4",children:(0,s.jsx)("div",{className:"space-y-4",children:ee.recipients?.filter(e=>"manual_send_required"===e.status).length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(y.AlertCircle,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium text-yellow-800 dark:text-yellow-300",children:"Manual Send Required"}),(0,s.jsx)("p",{className:"text-sm text-yellow-700 dark:text-yellow-400 mt-1",children:"Gmail is not connected for automatic sending. You'll need to send these emails manually."}),(0,s.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,s.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>window.open("/api/gmail/auth?userId=1","_blank"),children:"Connect Gmail"}),(0,s.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>{let e=ee.recipients?.filter(e=>"manual_send_required"===e.status)||[];if(e.length>0){let s=e[0],t=`https://mail.google.com/mail/?view=cm&to=${encodeURIComponent(s.email)}&su=${encodeURIComponent(s.emailSubject||"")}&body=${encodeURIComponent(s.emailContent||"")}`;window.open(t,"_blank")}},children:"Open in Gmail"})]})]})]})}),(0,s.jsx)(H,{recipients:ee.recipients?.filter(e=>"manual_send_required"===e.status)||[]})]}):(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(B.Check,{className:"h-8 w-8 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No manual sends required"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"All emails are being sent automatically"})]})})}),(0,s.jsx)(x.TabsContent,{value:"failed",className:"mt-4",children:(0,s.jsx)("div",{className:"space-y-4",children:ee.recipients?.filter(e=>"failed_generation"===e.status||"failed_send"===e.status).length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>eo(ee.id),children:[(0,s.jsx)(E.RefreshCw,{className:"h-4 w-4 mr-1"}),"Retry Failed"]})}),(0,s.jsx)(H,{recipients:ee.recipients?.filter(e=>"failed_generation"===e.status||"failed_send"===e.status)||[],showError:!0})]}):(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(B.Check,{className:"h-8 w-8 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No failed recipients"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"All emails processed successfully"})]})})})]})})]})}),(0,s.jsx)(x.TabsContent,{value:"review",children:(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsx)(c.CardTitle,{children:"Email Review Queue"}),(0,s.jsx)(c.CardDescription,{children:"Review and approve generated emails before sending"})]}),(0,s.jsx)(c.CardContent,{children:ee.recipientsInReview&&ee.recipientsInReview.length>0?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-2 justify-end pb-4 border-b",children:[(0,s.jsxs)(d.Button,{variant:"outline",onClick:()=>ed(ee.id,ee.recipientsInReview.map(e=>e.id)),children:[(0,s.jsx)(q.X,{className:"h-4 w-4 mr-1"}),"Reject All"]}),(0,s.jsxs)(d.Button,{onClick:()=>er(ee.id,ee.recipientsInReview.map(e=>e.id)),children:[(0,s.jsx)(B.Check,{className:"h-4 w-4 mr-1"}),"Approve All"]})]}),(0,s.jsx)("div",{className:"space-y-4",children:ee.recipientsInReview.slice(0,3).map(e=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-medium",children:["To: ",e.firstName," ",e.lastName]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.email," • ",e.companyName]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.Button,{size:"sm",variant:"outline",onClick:()=>em(ee.id,e.id),children:(0,s.jsx)(q.X,{className:"h-3 w-3"})}),(0,s.jsx)(d.Button,{size:"sm",onClick:()=>ec(ee.id,e.id),children:(0,s.jsx)(B.Check,{className:"h-3 w-3"})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Subject"}),(0,s.jsx)("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:e.emailSubject})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Body"}),(0,s.jsx)("div",{className:"text-sm p-3 bg-muted rounded max-h-48 overflow-y-auto",dangerouslySetInnerHTML:{__html:e.emailContent||""}})]})]})]},e.id))}),ee.recipientsInReview.length>3&&(0,s.jsxs)("div",{className:"text-center text-sm text-muted-foreground pt-2",children:["Showing 3 of ",ee.recipientsInReview.length," emails for review"]})]}):(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(v.Mail,{className:"h-8 w-8 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No emails pending review"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"Emails will appear here after generation"})]})})]})}),(0,s.jsx)(x.TabsContent,{value:"activity",children:(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsx)(c.CardTitle,{children:"Activity Timeline"}),(0,s.jsx)(c.CardDescription,{children:"Recent campaign events and batch history"})]}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,s.jsx)("div",{className:"h-2 w-2 rounded-full bg-green-500 mt-2"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"Campaign started"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:ee.startDate?(0,_.format)(new Date(ee.startDate),"MMM d, h:mm a"):"Not started"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Campaign activated and ready to send emails"})]})]}),ee.emailsSent>0&&(0,s.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,s.jsx)("div",{className:"h-2 w-2 rounded-full bg-blue-500 mt-2"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"Batch sent"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Today"})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Sent ",ee.emailsSent," emails to recipients"]})]})]}),ee.emailsOpened>0&&(0,s.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,s.jsx)("div",{className:"h-2 w-2 rounded-full bg-purple-500 mt-2"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"Recipients engaged"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Ongoing"})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[ee.emailsOpened," opens, ",ee.emailsClicked," clicks recorded"]})]})]}),"paused"===ee.status&&(0,s.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,s.jsx)("div",{className:"h-2 w-2 rounded-full bg-yellow-500 mt-2"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"Campaign paused"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:ee.updatedAt?(0,_.format)(new Date(ee.updatedAt),"MMM d, h:mm a"):"Recently"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Campaign temporarily paused"})]})]}),"completed"===ee.status&&(0,s.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,s.jsx)("div",{className:"h-2 w-2 rounded-full bg-gray-500 mt-2"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"Campaign completed"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:ee.endDate?(0,_.format)(new Date(ee.endDate),"MMM d, h:mm a"):"Recently"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"All scheduled emails have been sent"})]})]}),(!ee.emailsSent||0===ee.emailsSent)&&"completed"!==ee.status&&(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No activity yet. Campaign will start sending emails based on schedule."})]})})]})})]}),ee&&ee.autopilotSettings&&(0,s.jsx)(L.AutopilotModal,{open:G,onOpenChange:K,settings:"string"==typeof ee.autopilotSettings?JSON.parse(ee.autopilotSettings):ee.autopilotSettings,onApply:async e=>{await ei.mutateAsync({autopilotSettings:e}),K(!1),$({title:"Schedule Updated",description:"Campaign autopilot schedule has been updated successfully."})},totalEmails:ee.totalRecipients||100}),(0,s.jsx)(p.Dialog,{open:X,onOpenChange:V,children:(0,s.jsxs)(p.DialogContent,{className:"sm:max-w-md",children:[(0,s.jsxs)(p.DialogHeader,{children:[(0,s.jsx)(p.DialogTitle,{children:"Restart Campaign"}),(0,s.jsx)(p.DialogDescription,{children:"Choose how you want to restart this campaign"})]}),(0,s.jsx)("div",{className:"grid gap-4 py-4",children:(0,s.jsxs)(h.RadioGroup,{value:Y,onValueChange:e=>J(e),children:[(0,s.jsxs)("div",{className:"flex items-start space-x-3 space-y-0",children:[(0,s.jsx)(h.RadioGroupItem,{value:"failed",id:"failed",className:"mt-1"}),(0,s.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,s.jsx)(j.Label,{htmlFor:"failed",className:"cursor-pointer",children:"Only queue failed recipients"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Re-queue recipients whose emails failed to send or generate"})]})]}),(0,s.jsxs)("div",{className:"flex items-start space-x-3 space-y-0 mt-4",children:[(0,s.jsx)(h.RadioGroupItem,{value:"all",id:"all",className:"mt-1"}),(0,s.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,s.jsx)(j.Label,{htmlFor:"all",className:"cursor-pointer",children:"Resend to all campaign recipients"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Start over and re-send emails to everyone in the campaign"})]})]})]})}),(0,s.jsxs)(p.DialogFooter,{children:[(0,s.jsx)(d.Button,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),(0,s.jsx)(d.Button,{onClick:()=>{el.mutate(Y)},disabled:el.isPending,children:el.isPending?"Restarting...":"Restart Campaign"})]})]})})]})}e.s(["default",()=>$],47582)},74485,e=>{e.n(e.i(47582))}]);