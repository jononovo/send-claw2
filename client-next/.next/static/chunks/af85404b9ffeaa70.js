(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20099,e=>{"use strict";e.s([],93421),e.s([],90057);var t=e.i(43476),a=e.i(71645),s=e.i(74080);let i=["BUTTON","A","INPUT","TEXTAREA","SELECT","LABEL"],r=["button","link","menuitem","tab","checkbox","radio","switch","option"];function o(e){return e.replace(/["\\]/g,"\\$&")}function n(e){return e.replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/:/g,"\\:").replace(/\//g,"\\/")}function l(e){return!!(/^radix-:r[a-z0-9]+:/i.test(e)||/^:r[a-z0-9]+:/i.test(e)||/^headlessui-\w+-\d+$/.test(e))}function c(e){let t=e.textContent?.trim();if(t&&t.length>0&&t.length<=50)return t;let a=e.querySelector("svg");if(a){let e=a.getAttribute("class");if(e){let t=e.split(" ").find(e=>e.includes("icon")||e.includes("Icon")||e.includes("lucide")||e.includes("fa-"));if(t)return`svg:${t}`}let t=a.querySelector("use");if(t){let e=t.getAttribute("href")||t.getAttribute("xlink:href");if(e)return`svg:${e}`}}let s=e.querySelector("img");if(s){let e=s.getAttribute("alt");if(e)return`img:${e}`}}function d(e){let t=function(e){let t=e;for(;t;){if(i.includes(t.tagName))return t;let e=t.getAttribute("role");if(e&&r.includes(e)||t.hasAttribute("data-testid")||t.onclick||t.hasAttribute("onclick"))return t;t=t.parentElement}return e}(e),a=function(e){if(e.dataset.testid)return`[data-testid="${o(e.dataset.testid)}"]`;if(e.id&&!l(e.id))return`#${e.id}`;let t=e.getAttribute("aria-label");if(t)return`${e.tagName.toLowerCase()}[aria-label="${o(t)}"]`;let a=e.getAttribute("role");if(a){let t=e.getAttribute("type");return t?`[role="${a}"][type="${t}"]`:`${e.tagName.toLowerCase()}[role="${a}"]`}if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){let t=e.getAttribute("name");if(t)return`${e.tagName.toLowerCase()}[name="${o(t)}"]`;let a=e.getAttribute("placeholder");if(a)return`${e.tagName.toLowerCase()}[placeholder="${o(a)}"]`}if(e.className&&"string"==typeof e.className){let t=e.className.split(" ").filter(e=>e&&!e.startsWith("hover:")&&!e.startsWith("focus:")&&!e.startsWith("active:")).slice(0,3).map(n);if(t.length>0)return`${e.tagName.toLowerCase()}.${t.join(".")}`}return e.tagName.toLowerCase()}(t),s=function(e,t=4){let a=e.parentElement,s=0;for(;a&&s<t;){if(a.id&&!l(a.id)||a.dataset.testid||a.getAttribute("aria-label"))return a;let e=a.getAttribute("role");if(e&&["main","navigation","dialog","form","region","article","section"].includes(e)||["MAIN","NAV","HEADER","FOOTER","ASIDE","FORM","DIALOG"].includes(a.tagName))return a;a=a.parentElement,s++}return null}(t),d=s?function(e){if(e.id&&!l(e.id))return`#${e.id}`;if(e.dataset.testid)return`[data-testid="${o(e.dataset.testid)}"]`;let t=e.getAttribute("aria-label");if(t)return`[aria-label="${o(t)}"]`;let a=e.getAttribute("role");return a?`[role="${a}"]`:e.tagName.toLowerCase()}(s):null,u=d?`${d} ${a}`:a;try{let e=document.querySelectorAll(u);if(1===e.length)return{selector:u};if(e.length>1){let a=c(t);if(a)return{selector:u,contentMatch:a};let s=0;for(let a=0;a<e.length;a++)if(e[a]===t){s=a+1;break}if(s>0)return{selector:`${u}:nth-of-type(${s})`,contentMatch:c(t)}}}catch{}return{selector:u,contentMatch:c(t)}}function u(e,t){try{let a=document.querySelectorAll(e);if(1===a.length)return a[0];if(a.length>1&&t)for(let e=0;e<a.length;e++){let s=a[e],i=s.textContent?.trim()||"";if(i===t||i.includes(t))return s;if(t.startsWith("svg:")){let e=t.slice(4),a=s.querySelector("svg");if(a){if((a.getAttribute("class")||"").includes(e))return s;let t=a.querySelector("use");if((t?.getAttribute("href")||t?.getAttribute("xlink:href")||"").includes(e))return s}}if(t.startsWith("img:")){let e=t.slice(4),a=s.querySelector("img");if(a&&a.getAttribute("alt")===e)return s}}if(a.length>0)return a[0]}catch{}return null}function p({targetSelector:e,contentMatch:i,isVisible:r,actionType:o}){let[n,l]=(0,a.useState)(null),c=(0,a.useRef)();if((0,a.useEffect)(()=>{if(!r||!e)return void l(null);let t=()=>{try{let t=u(e,i);if(t){let e=t.getBoundingClientRect();l(e)}else l(null)}catch(e){l(null)}c.current=requestAnimationFrame(t)};return t(),()=>{c.current&&cancelAnimationFrame(c.current)}},[e,i,r]),!r||!n)return null;let d="type"===o,p={position:"fixed",top:n.top-6+window.scrollY,left:n.left-6,width:n.width+12,height:n.height+12,border:d?"3px dashed #60a5fa":"3px solid #facc15",borderRadius:"8px",boxShadow:d?"0 0 12px 2px rgba(96, 165, 250, 0.4)":"0 0 12px 2px rgba(250, 204, 21, 0.4)",pointerEvents:"none",zIndex:9998,animation:d?"guidance-type-pulse 1.5s infinite":"guidance-pulse 2s infinite"};return(0,s.createPortal)((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{children:`
          @keyframes guidance-pulse {
            0% { box-shadow: 0 0 12px 2px rgba(250, 204, 21, 0.4); }
            50% { box-shadow: 0 0 18px 3px rgba(250, 204, 21, 0.6); }
            100% { box-shadow: 0 0 12px 2px rgba(250, 204, 21, 0.4); }
          }
          @keyframes guidance-type-pulse {
            0% { box-shadow: 0 0 12px 2px rgba(96, 165, 250, 0.4); border-color: #60a5fa; }
            50% { box-shadow: 0 0 18px 3px rgba(96, 165, 250, 0.6); border-color: #93c5fd; }
            100% { box-shadow: 0 0 12px 2px rgba(96, 165, 250, 0.4); border-color: #60a5fa; }
          }
        `}),(0,t.jsx)("div",{style:p,"data-testid":"element-highlight"})]}),document.body)}function m({targetSelector:e,contentMatch:i,isVisible:r}){let[o,n]=(0,a.useState)(null),l=(0,a.useRef)();if((0,a.useEffect)(()=>{if(!r||!e)return void n(null);let t=()=>{let a=u(e,i);a?n(a.getBoundingClientRect()):n(null),l.current=requestAnimationFrame(t)};return t(),()=>{l.current&&cancelAnimationFrame(l.current)}},[e,i,r]),!r)return null;let c=o?{left:o.left-10,top:o.top-10,right:o.right+10,bottom:o.bottom+10}:null,d=c?`polygon(
        0 0, 100% 0, 100% 100%, 0 100%, 0 0,
        ${c.left}px ${c.top}px,
        ${c.right}px ${c.top}px,
        ${c.right}px ${c.bottom}px,
        ${c.left}px ${c.bottom}px,
        ${c.left}px ${c.top}px
      )`:void 0;return(0,s.createPortal)((0,t.jsx)("div",{className:"fixed inset-0 bg-black/40 z-[9997] pointer-events-none transition-all duration-300",style:{clipPath:d},"data-testid":"spotlight-overlay"}),document.body)}var h=e.i(46932),g=e.i(88653),x=e.i(73375),f=e.i(63059),y=e.i(37727);let b={src:e.i(41130).default,width:150,height:201,blurWidth:6,blurHeight:8,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAICAYAAADaxo44AAAA00lEQVR42gHIADf/AAMCAQMEBAIFPjklRZeKVaSLfkiYCQgFCgBXSRpoWUcga7WRTNbSuVf/uqVT3yYjGCoAtJUq4bSLKt23ah/5vI4p/7GXQeInIxosAH1lGp7LpjP1xJ4w/baNI/VqWCiFBwYFCAAjHhEpuaBG3tGzQf/NsUb3kIJNoA8OChAAFhMMGpR2JM2zjB//tYwj/76jSup0ZzqHAAMCAQM7Jw1XhE8Vz4tTEdJINBBmGhUIIQANCgcQWD8samZBKX1/TyyfNiIUQgAAAABFx0cdVItGRgAAAABJRU5ErkJggg=="};function w({targetSelector:e,contentMatch:i,instruction:r,position:o="auto",isVisible:n,onDismiss:l,onBack:c,onClose:d,stepNumber:p,totalSteps:m,playbackMode:w="guide",onModeToggle:v,hasVideo:j}){let[N,k]=(0,a.useState)(null),C=(0,a.useRef)(),S=(0,a.useCallback)(()=>{let t=null;try{t=u(e,i)}catch(e){k(null);return}if(!t)return void k(null);let a=t.getBoundingClientRect(),s=o;if("auto"===o){let e=a.top,t=window.innerHeight-a.bottom;a.left;let i=window.innerWidth-a.right;s=t>=116?"bottom":e>=116?"top":i>=276?"right":"left"}let r=0,n=0,l="top";switch(s){case"bottom":r=a.bottom+16,n=a.left+a.width/2-130,l="top";break;case"top":r=a.top-100-16,n=a.left+a.width/2-130,l="bottom";break;case"right":r=a.top+a.height/2-50,n=a.right+16+40,l="left";break;case"left":r=a.top+a.height/2-50,n=a.left-260-16,l="right"}n=Math.max(10,Math.min(n,window.innerWidth-260-10)),k({top:r=Math.max(10,Math.min(r,window.innerHeight-100-10)),left:n,arrowPosition:l})},[e,i,o]);return((0,a.useEffect)(()=>{if(!n||!e)return void k(null);let t=()=>{S(),C.current=requestAnimationFrame(t)};return t(),()=>{C.current&&cancelAnimationFrame(C.current)}},[e,n,S]),n&&N)?(0,s.createPortal)((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{children:`
          @keyframes mascot-wiggle {
            0% { transform: translateY(0) rotate(0deg); }
            2% { transform: translateY(-4px) rotate(0deg); }
            4% { transform: translateY(0) rotate(0deg); }
            4%, 35% { transform: translateY(0) rotate(0deg); }
            36% { transform: rotate(5deg); }
            37% { transform: rotate(-5deg); }
            38% { transform: rotate(0deg); }
            38%, 75% { transform: translateY(0) rotate(0deg); }
            77% { transform: translateY(-2px) rotate(2deg); }
            79% { transform: translateY(-3px) rotate(-1deg); }
            81% { transform: translateY(-1px) rotate(1deg); }
            83% { transform: translateY(0) rotate(0deg); }
            83%, 100% { transform: translateY(0) rotate(0deg); }
          }
          .mascot-wiggle {
            animation: mascot-wiggle 12s ease-in-out infinite;
          }
        `}),(0,t.jsx)(g.AnimatePresence,{children:n&&(0,t.jsxs)(h.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2},className:"fixed z-[9999] w-[260px] bg-gray-800 text-white rounded-lg shadow-2xl border border-yellow-500/30",style:{top:N.top,left:N.left},"data-testid":"guidance-tooltip","data-recorder-ui":"true",children:[(0,t.jsx)("div",{style:{top:{position:"absolute",top:"-8px",left:"50%",transform:"translateX(-50%)",borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderBottom:"8px solid #1f2937"},bottom:{position:"absolute",bottom:"-8px",left:"50%",transform:"translateX(-50%)",borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderTop:"8px solid #1f2937"},left:{position:"absolute",left:"-8px",top:"50%",transform:"translateY(-50%)",borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderRight:"8px solid #1f2937"},right:{position:"absolute",right:"-8px",top:"50%",transform:"translateY(-50%)",borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderLeft:"8px solid #1f2937"}}[N.arrowPosition]}),(0,t.jsx)("img",{src:b.src,alt:"Duckling guide",className:"absolute -left-12 -top-2 w-10 h-10 mascot-wiggle object-contain drop-shadow-[0_2px_4px_rgba(0,0,0,0.15)]"}),(0,t.jsx)("div",{className:"p-3",children:(0,t.jsx)("div",{className:"flex items-start gap-2",children:(0,t.jsxs)("p",{className:"text-sm text-gray-200 leading-snug flex-1",children:["show"===w?(0,t.jsxs)("span",{className:"text-yellow-400 italic",children:["Watching: ",r]}):r,(0,t.jsxs)("span",{className:"inline-flex items-center align-middle ml-1",children:[p&&p>1&&c&&"guide"===w&&(0,t.jsx)("button",{className:"text-gray-400 hover:text-yellow-400 h-5 w-5 p-0 inline-flex items-center justify-center transition-colors",onClick:c,"data-testid":"tooltip-back",children:(0,t.jsx)(x.ChevronLeft,{className:"h-3.5 w-3.5"})}),p&&m&&(0,t.jsxs)("span",{className:"text-xs text-gray-400 font-medium",children:[p," / ",m]}),"guide"===w&&(0,t.jsx)("button",{className:"text-gray-400 hover:text-yellow-400 h-5 w-5 p-0 inline-flex items-center justify-center transition-colors",onClick:l,"data-testid":"tooltip-next",children:(0,t.jsx)(f.ChevronRight,{className:"h-3.5 w-3.5"})}),d&&(0,t.jsx)("button",{className:"text-gray-400 hover:text-red-400 h-5 w-5 p-0 ml-1 inline-flex items-center justify-center transition-colors",onClick:d,"data-testid":"tooltip-close",title:"Close guidance",children:(0,t.jsx)(y.X,{className:"h-3.5 w-3.5"})})]})]})})})]})})]}),document.body):null}var v=e.i(18566),j=e.i(75254);let N=(0,j.default)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);var k=e.i(31343),C=e.i(14683);let S=(0,j.default)("Pointer",[["path",{d:"M22 14a8 8 0 0 1-8 8",key:"56vcr3"}],["path",{d:"M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1agjmk"}],["path",{d:"M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1",key:"wdbh2u"}],["path",{d:"M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10",key:"1ibuk9"}],["path",{d:"M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"g6ys72"}]]);var A=e.i(83086),I=e.i(24487),E=e.i(52044),T=e.i(31278),P=e.i(43531),M=e.i(74886),L=e.i(64659),Q=e.i(69074),R=e.i(9826);let $=(0,j.default)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),D=(0,j.default)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var q=e.i(27612),F=e.i(56909),G=e.i(7233);let z=(0,j.default)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var Y=e.i(6625),O=e.i(37880),V=e.i(90250),B=e.i(91593),U=e.i(67244);let H={startDelay:5e3,advanceDelay:400,completionCredits:110};function _(e,t){return"number"==typeof e?e:H[t]}let J=[{id:"finding-customers",name:"Finding Customers",description:"Discover potential customers using our powerful AI search tools.",emoji:"ðŸ”",challenges:[{id:"basic-company-contact-search",name:"Basic Company & Contact Search",description:"Perform your first company and contacts search",emoji:"ðŸŽ¯",trigger:{type:"newUser",route:"/app",requiresAuth:!0,once:!0},startDelay:7e3,setupEvent:"startNewSearch",steps:[{id:"open-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click on the search options to choose what you want to search for",tooltipPosition:"right",route:"/app"},{id:"select-contacts-search",selector:'[data-testid="search-type-option-contacts"]',action:"click",instruction:"Select '+ Contacts' to search for companies AND their contacts",tooltipPosition:"bottom",route:"/app"},{id:"search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search bar to start.",tooltipPosition:"bottom",route:"/app"},{id:"type-query",selector:'[data-testid="search-input"]',action:"type",value:"marketing agencies in Austin",advanceDelay:3e3,instruction:"Type a search query like 'marketing agencies in Austin'.",tooltipPosition:"bottom",route:"/app"},{id:"execute-search",selector:'[data-testid="search-button"]',action:"click",instruction:"Click on Search!",tooltipPosition:"left",route:"/app"}],completionMessage:"Awesome! You've completed your first search! ðŸŽ‰"},{id:"cross-page-navigation",name:"Navigate the App",description:"Learn to navigate between different sections using the sidebar",emoji:"ðŸ§­",steps:[{id:"click-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"First, click on the search bar",tooltipPosition:"bottom",route:"/app"},{id:"open-drawer-1",selector:'[data-testid="button-open-drawer"]',action:"click",instruction:"Now click the menu icon to open the navigation drawer",tooltipPosition:"right",route:"/app"},{id:"go-to-contacts",selector:'[data-testid="drawer-nav-contacts"]',action:"click",instruction:"Click 'Contact Lists' to see your saved contacts",tooltipPosition:"right",route:"/app"},{id:"open-drawer-2",selector:'[data-testid="button-open-drawer"]',action:"click",instruction:"Great! Now open the drawer again",tooltipPosition:"right",route:"/contacts"},{id:"go-to-campaigns",selector:'[data-testid="drawer-nav-campaigns"]',action:"click",instruction:"Now go to 'Campaigns' to manage your outreach",tooltipPosition:"right",route:"/contacts"},{id:"open-drawer-3",selector:'[data-testid="button-open-drawer"]',action:"click",instruction:"Open the drawer one more time",tooltipPosition:"right",route:"/campaigns"},{id:"go-back-to-search",selector:'[data-testid="drawer-new-search"]',action:"click",instruction:"Click 'New Search' to return to the main search page",tooltipPosition:"right",route:"/campaigns"}],completionMessage:"Excellent! You now know how to navigate the app! ðŸ§­"},{id:"find-email-unique-contact",name:"Find Email of Unique Contact",description:"Use the email finder to discover a specific contact's email",emoji:"ðŸ“§",steps:[],completionMessage:"Excellent! You've discovered how to find contact emails! ðŸ“¬"},{id:"full-search",name:"Do a Full Search",description:"Complete a full search with contacts and emails in one go",emoji:"ðŸš€",steps:[],completionMessage:"Congratulations! You've mastered the complete search workflow! ðŸŽ‰"},{id:"search-emails-with-filters",name:"Search for Emails with Filters",description:"Learn how to use search options, apply filters, and perform targeted email searches",emoji:"ðŸ“§",steps:[{id:"open-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click the search options button to access advanced search features",tooltipPosition:"bottom",route:"/app"},{id:"select-emails-option",selector:'[role="dialog"] [data-testid="search-type-option-emails"]',action:"click",instruction:"Select the 'Emails' option to search specifically for email contacts",tooltipPosition:"right",route:"/app"},{id:"add-leadership-filter",selector:"button.flex.items-center.gap-1",action:"click",instruction:"Click on 'Leadership' to add it as a filter for your search",tooltipPosition:"bottom",route:"/app"},{id:"add-marketing-filter",selector:"button.\n.flex.items-center",action:"click",instruction:"Click on 'Marketing' to add another filter to narrow your search",tooltipPosition:"bottom",route:"/app"},{id:"click-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search input field to start entering your search query",tooltipPosition:"bottom",route:"/app"},{id:"enter-search-query",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your search query to find specific contacts",tooltipPosition:"bottom",route:"/app",value:"plumbers in brooklyn"},{id:"finalize-search",selector:"body.react-loaded",action:"click",instruction:"Click outside the search area to execute your filtered search",tooltipPosition:"auto",route:"/app"}],completionMessage:"Great job! You've learned how to use search options, apply multiple filters, and perform targeted email searches to find exactly the contacts you need."},{id:"advanced-search-configuration",name:"Configure Advanced Search",description:"Learn how to set up advanced search options and customize your search query",emoji:"ðŸ”",steps:[{id:"open-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click the search options button to access advanced search settings",tooltipPosition:"bottom",route:"/app/new-search"},{id:"select-super-search",selector:'[role="dialog"] [data-testid="search-type-option-super_search_fast"]',action:"click",instruction:"Select 'Super Search (Fast)' to use the most powerful search algorithm",tooltipPosition:"right",route:"/app/new-search"},{id:"click-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click in the search input field to start entering your query",tooltipPosition:"bottom",route:"/app/new-search"},{id:"enter-search-query",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your specific search query about Tesla engineers in Germany",tooltipPosition:"bottom",route:"/app/new-search",value:"Find tesla engineers in germany working on lithium sourcing or batteries."},{id:"add-marketing-filter",selector:"button.flex.items-center.gap-1",action:"click",instruction:"Click to add Marketing as a filter category",tooltipPosition:"top",route:"/app/new-search"},{id:"add-leadership-filter",selector:"button.\n.flex.items-center",action:"click",instruction:"Click to add Leadership as an additional filter category",tooltipPosition:"top",route:"/app/new-search"}],completionMessage:"Great job! You've learned how to configure advanced search options, select search types, enter detailed queries, and apply multiple filters to refine your results."},{id:"advanced-search-setup-with-filters",name:"Advanced Search Setup",description:"Learn how to configure search options, enter specific queries, and apply professional filters",emoji:"ðŸ”",steps:[{id:"open-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click the search options button to access advanced search settings",tooltipPosition:"bottom",route:"/app/new-search"},{id:"select-super-search",selector:'[role="dialog"] [data-testid="search-type-option-super_search_fast"]',action:"click",instruction:"Select 'Super Search (Fast)' for enhanced search capabilities",tooltipPosition:"right",route:"/app/new-search"},{id:"focus-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click in the search field to start entering your query",tooltipPosition:"bottom",route:"/app/new-search"},{id:"enter-search-query",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your specific search query about Tesla engineers",tooltipPosition:"bottom",route:"/app/new-search",value:"tesla engineers working on lithium sourcing"},{id:"confirm-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click to confirm your search input",tooltipPosition:"bottom",route:"/app/new-search"},{id:"select-leadership-filter",selector:"button.flex.items-center.gap-1",action:"click",instruction:"Click on the 'Leadership' filter to narrow down to leadership roles",tooltipPosition:"top",route:"/app/new-search"},{id:"select-cto-filter",selector:"button.\n.flex.items-center",action:"click",instruction:"Select 'CTO' to specifically target Chief Technology Officers",tooltipPosition:"top",route:"/app/new-search"}],completionMessage:"Great job! You've learned how to set up an advanced search with specific queries and professional filters. This will help you find exactly the type of professionals you're looking for!"},{id:"advanced-search-with-filters",name:"Advanced Search with Filters",description:"Learn how to perform targeted searches with email options and job level filters",emoji:"ðŸ”",steps:[{id:"open-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click the search options button to access advanced search settings",tooltipPosition:"bottom",route:"/app/new-search"},{id:"select-email-option",selector:'[role="dialog"] [data-testid="search-type-option-emails"]',action:"click",instruction:"Select the 'Emails' option to include email data in your search results",tooltipPosition:"right",route:"/app/new-search"},{id:"click-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search input field to start entering your search criteria",tooltipPosition:"top",route:"/app/new-search"},{id:"enter-search-query",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your search query to find specific professionals",tooltipPosition:"top",route:"/app/new-search",value:"tesla engineers working on batteries in germany"},{id:"select-cto-filter",selector:"button.flex.items-center.gap-1",action:"click",instruction:"Click on 'CTO' to add this job title filter to your search",tooltipPosition:"bottom",route:"/app/new-search"},{id:"select-leadership-filter",selector:"button.\n.flex.items-center",action:"click",instruction:"Click on 'Leadership' to broaden your search to include leadership roles",tooltipPosition:"bottom",route:"/app/new-search"},{id:"execute-search",selector:'[data-testid="search-button"]',action:"click",instruction:"Click the Search button to execute your advanced search with all selected filters",tooltipPosition:"top",route:"/app/new-search"}],completionMessage:"Great job! You've learned how to perform advanced searches with email options and job level filters. This will help you find more targeted and relevant professional contacts!"},{id:"configure-email-search-criteria",name:"Configure Email Search Criteria",description:"Learn how to set up email search options and customize search criteria for targeted results",emoji:"ðŸ“§",steps:[{id:"step-1",selector:"#root",action:"click",instruction:"Click on the main area to start configuring your search",tooltipPosition:"bottom",route:"/app/new-search"},{id:"step-2",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click the search options button to open advanced search settings",tooltipPosition:"bottom",route:"/app/new-search"},{id:"step-3",selector:'[role="dialog"] [data-testid="search-type-option-emails"]',action:"click",instruction:"Select the 'Emails' option to include email results in your search",tooltipPosition:"left",route:"/app/new-search"},{id:"step-4",selector:'[data-testid="search-input"]',action:"click",instruction:"Click in the search input field to enter your search terms",tooltipPosition:"bottom",route:"/app/new-search"},{id:"step-5",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your search query to find what you're looking for",tooltipPosition:"bottom",route:"/app/new-search",value:"happy people"},{id:"step-6",selector:"button.flex.items-center.gap-1",action:"click",instruction:"Click the Leadership filter to refine your search criteria",tooltipPosition:"top",route:"/app/new-search"},{id:"step-7",selector:"button.\n.flex.items-center",action:"click",instruction:"Click the Marketing filter to add another search criteria",tooltipPosition:"top",route:"/app/new-search"}],completionMessage:"Great job! You've learned how to configure email search options, enter search terms, and apply multiple filters to get targeted results."},{id:"search-and-filter-exploration",name:"Search and Filter Tutorial",description:"Learn how to access search history, perform searches, and apply filters",emoji:"ðŸ”",steps:[{id:"open-drawer",selector:'nav [data-testid="button-open-drawer"]',action:"click",instruction:"Click the drawer button to open your search history",tooltipPosition:"bottom",route:"/app"},{id:"click-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search input field to start entering your search",tooltipPosition:"bottom",route:"/app"},{id:"enter-search-term",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your search term in the input field",tooltipPosition:"bottom",route:"/app",value:"happy"},{id:"apply-first-filter",selector:"button.flex.items-center.gap-1",action:"click",instruction:"Click this filter button to refine your search results",tooltipPosition:"top",route:"/app"},{id:"apply-second-filter",selector:"button.\n.flex.items-center",action:"click",instruction:"Apply another filter to further narrow down your results",tooltipPosition:"top",route:"/app"}],completionMessage:"Great job! You've learned how to access search history, perform searches, and apply multiple filters to get the most relevant results."},{id:"advanced-search-with-super-search",name:"Advanced Search Tutorial",description:"Learn how to use different search types and perform advanced queries",emoji:"ðŸ”",steps:[{id:"click-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search input field to get started",tooltipPosition:"bottom",route:"/app"},{id:"open-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click the search options button to see different search types",tooltipPosition:"bottom",route:"/app"},{id:"explore-individual-search",selector:'[role="dialog"] [data-testid="search-type-option-individual_search"]',action:"click",instruction:"Try selecting 'Find Individual' to see what this search type offers",tooltipPosition:"left",route:"/app"},{id:"cancel-individual-search",selector:'form [data-testid="button-cancel"]',action:"click",instruction:"Cancel this option to explore other search types",tooltipPosition:"top",route:"/app"},{id:"reopen-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Open the search options again to choose a different search type",tooltipPosition:"bottom",route:"/app"},{id:"select-super-search",selector:'[role="dialog"] [data-testid="search-type-option-super_search_fast"]',action:"click",instruction:"Select 'Super Search (Fast)' for more powerful search capabilities",tooltipPosition:"left",route:"/app"},{id:"focus-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click in the search field to prepare for your query",tooltipPosition:"bottom",route:"/app"},{id:"type-advanced-query",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your detailed search query about AI engineers at Tesla",tooltipPosition:"bottom",route:"/app",value:"find engineers that focus on ai vision at tesla in germany"},{id:"execute-search",selector:'[data-testid="search-button"]',action:"click",instruction:"Click the search button to run your advanced query",tooltipPosition:"left",route:"/app"}],completionMessage:"Great job! You've learned how to explore different search types and perform advanced queries using Super Search. You can now craft detailed searches to find exactly what you're looking for!"},{id:"search-contacts-with-filters",name:"Search Contacts with Filters",description:"Learn how to search for specific contacts using search filters and options",emoji:"ðŸ”",steps:[{id:"click-search-input-1",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search input field to start your search",tooltipPosition:"bottom",route:"/app"},{id:"click-search-input-2",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search input again to ensure it's focused",tooltipPosition:"bottom",route:"/app"},{id:"click-search-input-3",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search input once more to prepare for typing",tooltipPosition:"bottom",route:"/app"},{id:"type-search-query",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your search query in the input field",tooltipPosition:"bottom",route:"/app",value:"happy"},{id:"open-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click the search options button to access additional filters",tooltipPosition:"left",route:"/app"},{id:"select-contacts-filter",selector:'[role="dialog"] [data-testid="search-type-option-contacts"]',action:"click",instruction:"Select 'Contacts' to filter your search results to contacts only",tooltipPosition:"right",route:"/app"},{id:"select-leadership-filter-1",selector:"button.flex.items-center.gap-1",action:"click",instruction:"Click on the 'Leadership' filter to narrow your search to leadership contacts",tooltipPosition:"top",route:"/app"},{id:"select-leadership-filter-2",selector:"button.\n.flex.items-center",action:"click",instruction:"Confirm your leadership filter selection",tooltipPosition:"top",route:"/app"}],completionMessage:"Great job! You've learned how to use search filters to find specific contacts. You can now search effectively using keywords and apply filters like contact type and leadership roles to get more targeted results."},{id:"search-with-custom-options",name:"Search with Custom Options",description:"Learn how to configure search settings and perform a search with specific parameters",emoji:"ðŸ”",steps:[{id:"open-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click the search options button to configure your search settings",tooltipPosition:"bottom",route:"/app"},{id:"select-search-type",selector:'[role="dialog"] [data-testid="search-type-option-super_search_fast"]',action:"click",instruction:"Select 'Super Search (Fast)' to use the optimized search mode",tooltipPosition:"right",route:"/app"},{id:"focus-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search input field to start entering your search query",tooltipPosition:"top",route:"/app"},{id:"enter-search-query",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your search query in the input field",tooltipPosition:"top",route:"/app",value:"happy people"}],completionMessage:"Great job! You've learned how to customize search options and perform a search. Now you can use different search modes to find exactly what you're looking for!"},{id:"search-emails-with-suggestions",name:"Search for Emails with Suggestions",description:"Learn how to configure search options for emails and use search suggestions",emoji:"ðŸ“§",steps:[{id:"open-search-options",selector:'[data-testid="search-options-button"]',action:"click",instruction:"Click the search options button to configure your search settings",tooltipPosition:"bottom",route:"/app"},{id:"select-email-search",selector:'[role="dialog"] [data-testid="search-type-option-emails"]',action:"click",instruction:"Select 'Emails' to search specifically for email content",tooltipPosition:"right",route:"/app"},{id:"click-search-input",selector:'[data-testid="search-input"]',action:"click",instruction:"Click on the search input field to start typing your query",tooltipPosition:"top",route:"/app"},{id:"type-search-query",selector:'[data-testid="search-input"]',action:"type",instruction:"Type your search query in the input field",tooltipPosition:"top",route:"/app",value:"happy people 22222222"},{id:"select-suggestion",selector:'[data-testid="button-suggestion-recently-exited-startups-in-mi"]',action:"click",instruction:"Click on the suggested search term 'Recently exited startups in Miami' to use it as your query",tooltipPosition:"top",route:"/app"}],completionMessage:"Great job! You've learned how to configure search options for emails and use search suggestions to find relevant content more efficiently."}]},{id:"send-an-email",name:"Send an Email",description:"Learn how to compose and send personalized emails to your contacts.",emoji:"âœ‰ï¸",challenges:[{id:"generate-email-from-prompt",name:"Generate an Email from a Prompt",description:"Generate an email from a prompt and edit it",emoji:"âœï¸",steps:[],completionMessage:"You've created your first AI-generated email! âœ¨"},{id:"change-the-tone",name:"Change the Tone",description:"Adjust the tone of your email to match your style",emoji:"ðŸŽ­",steps:[],completionMessage:"You've learned how to adjust email tone! ðŸŽ¯"},{id:"add-strategy-guidance",name:"Add a Strategy Guidance",description:"Add strategic context to improve your email",emoji:"ðŸ§ ",steps:[],completionMessage:"You've added strategic guidance to your email! ðŸ’¡"},{id:"send-email-default-sender",name:"Send Email Using Default Sender",description:"Send your email using the default email sender",emoji:"ðŸ“¤",steps:[],completionMessage:"Congratulations! You've sent your first email! ðŸŽ‰"},{id:"add-product-to-contact",name:"Add Product Information",description:"Learn how to add product details to a contact profile",emoji:"ðŸ“",steps:[{id:"open-drawer",selector:'[data-testid="button-open-drawer"]',action:"click",instruction:"Click the drawer button to open the navigation menu",tooltipPosition:"bottom",route:"/app"},{id:"select-company",selector:"span.cursor-pointer",action:"click",instruction:"Click on 'edtech stem in vietnam' to select this company",tooltipPosition:"right",route:"/app"},{id:"select-contact",selector:"div.flex-1",action:"click",instruction:"Click on Nevill Nguyen's contact card to view their profile",tooltipPosition:"top",route:"/app"},{id:"focus-product-field",selector:"textarea.flex.min-h-\\[80px\\].w-full",action:"click",instruction:"Click on the product textarea field to start adding product information",tooltipPosition:"top",route:"/app"},{id:"enter-product-info",selector:"textarea.flex.min-h-\\[80px\\].w-full",action:"type",instruction:"Type 'sell edu platform.' to add product details for this contact",tooltipPosition:"top",route:"/app"}],completionMessage:"Great job! You've successfully learned how to navigate to a contact and add product information to their profile. This helps keep track of what products or services are relevant to each contact."},{id:"generate-email-from-profile",name:"Generate Email",description:"Learn how to generate an email by selecting a contact and providing context",emoji:"ðŸ“§",steps:[{id:"select-contact",selector:"div.font-medium.text-sm",action:"click",instruction:"Click on 'Pham Minh Tuan' to select this contact for your email",tooltipPosition:"bottom",route:"/app"},{id:"add-context",selector:"textarea.flex.min-h-\\[80px\\].w-full",action:"click",instruction:"Click in the text area and add context about 'sell edu platform' to help generate a relevant email",tooltipPosition:"top",route:"/app"},{id:"generate-email",selector:'[data-testid="button-generate-email"]',action:"click",instruction:"Click the 'Generate Email' button to create your personalized email",tooltipPosition:"top",route:"/app"}],completionMessage:"Great job! You've learned how to generate personalized emails by selecting a contact and providing relevant context. This will help you create more targeted and effective communications."}]},{id:"invite-a-friend",name:"Invite a Friend Who May Need This",description:"Share 5Ducks with someone who could benefit from better sales outreach.",emoji:"ðŸ¤",challenges:[]},{id:"manage-your-products",name:"Manage Your Products",description:"Set up and manage the products you're selling to personalize your outreach.",emoji:"ðŸ“¦",challenges:[]},{id:"manage-sender-profile",name:"Manage Your Sender Profile",description:"Configure your sender profile for professional email outreach.",emoji:"ðŸ‘¤",challenges:[]},{id:"launch-daily-ducks-assistant",name:"Launch Your Daily Ducks Assistant",description:"Set up your automated daily outreach assistant to stay consistent.",emoji:"ðŸ¦†",challenges:[{id:"decide-weekly-schedule",name:"Decide on Your Weekly Schedule",description:"Choose which days you want to send outreach emails",emoji:"ðŸ“…",steps:[],completionMessage:"You've set your weekly schedule! ðŸ“†"},{id:"select-streak-elements",name:"Select Streak Elements & Launch",description:"Choose your streak settings and launch your assistant",emoji:"ðŸ”¥",steps:[],completionMessage:"Your Daily Ducks Assistant is launched! ðŸš€"},{id:"schedule-holiday-pause",name:"Schedule a Holiday or Pause",description:"Learn how to pause your assistant when needed",emoji:"ðŸ–ï¸",steps:[],completionMessage:"You know how to manage your schedule! â¸ï¸"},{id:"generate-emails",name:"Mainly Generate the Emails",description:"Let the assistant generate emails for your outreach",emoji:"âœ¨",steps:[],completionMessage:"Your emails are ready to go! ðŸ’Œ"}]},{id:"daily-ducks",name:"Daily Ducks",description:"Master your daily outreach workflow with the Daily Ducks feature.",emoji:"ðŸ¦†",challenges:[{id:"test-send",name:"Test Send",description:"Send a test email to yourself before going live",emoji:"ðŸ§ª",steps:[],completionMessage:"Test email sent successfully! âœ…"},{id:"send-via-daily-ducks",name:"Send Email via Daily Ducks",description:"Send your first real email through Daily Ducks",emoji:"ðŸ“¤",steps:[],completionMessage:"Your first Daily Ducks email is on its way! ðŸŽ‰"},{id:"regenerate-suggestions",name:"Re-generate Daily Suggestions",description:"Learn how to refresh your daily email suggestions",emoji:"ðŸ”„",steps:[],completionMessage:"You've regenerated your suggestions! ðŸ”„"},{id:"stop-campaign",name:"Stop Daily Ducks Campaign",description:"Learn how to stop or pause your campaign",emoji:"â¹ï¸",steps:[],completionMessage:"You know how to manage your campaigns! ðŸ’ª"}]},{id:"help-your-community",name:"Help Your Community",description:"Give back and help others discover better sales tools.",emoji:"ðŸ’",challenges:[{id:"think-about-someone",name:"Think About Someone Who Needs Help with Sales",description:"Consider who in your network could benefit from this tool",emoji:"ðŸ’­",steps:[],completionMessage:"Thanks for thinking of others! ðŸ™"},{id:"give-feedback",name:"Give Feedback on the App",description:"Share your thoughts to help us improve",emoji:"ðŸ’¬",steps:[],completionMessage:"Thank you for your valuable feedback! ðŸ’œ"},{id:"create-video-post",name:"Create a Video or Post on Socials",description:"Share your experience and earn bonus credits",emoji:"ðŸŽ¬",steps:[],completionMessage:"Amazing! You've earned 5,000 bonus credits! ðŸŽ"}]},{id:"create-contact-list",name:"Create a Contact List",description:"Organize your contacts into lists for targeted outreach.",emoji:"ðŸ“‹",challenges:[{id:"create-new-list",name:"Create a New Contact List",description:"Create your first contact list",emoji:"âž•",steps:[],completionMessage:"You've created a new contact list! ðŸ“"},{id:"add-contact-to-list",name:"Add a Contact to Your Contact List",description:"Add an individual contact to your list",emoji:"ðŸ‘¤",steps:[],completionMessage:"Contact added successfully! âœ…"},{id:"add-company-to-list",name:"Add a Company to Contact List",description:"Add all contacts from a company to your list",emoji:"ðŸ¢",steps:[],completionMessage:"Company contacts added! ðŸ—ï¸"},{id:"add-all-from-search",name:"Add All Eligible from Search List",description:"Bulk add contacts from your search results",emoji:"ðŸ“¥",steps:[],completionMessage:"All eligible contacts added! ðŸŽ¯"}]},{id:"tinkering-contact-lists",name:"Tinkering with Contact Lists",description:"Advanced contact list management techniques.",emoji:"ðŸ”§",challenges:[{id:"manual-typing",name:"Add Contacts with Manual Typing",description:"Manually enter contact information",emoji:"âŒ¨ï¸",steps:[],completionMessage:"Contact added manually! âœï¸"},{id:"remove-contact",name:"Remove a Contact from a Contact List",description:"Learn how to remove contacts from your lists",emoji:"ðŸ—‘ï¸",steps:[],completionMessage:"Contact removed successfully! ðŸ‘‹"},{id:"copy-paste-csv",name:"Copy and Paste CSV",description:"Import contacts by pasting CSV data",emoji:"ðŸ“‹",steps:[],completionMessage:"Contacts imported from CSV! ðŸ“Š"},{id:"export-to-csv",name:"Export List to CSV",description:"Export your contact list for external use",emoji:"ðŸ“¤",steps:[],completionMessage:"List exported successfully! ðŸ’¾"}]},{id:"connect-gmail-api",name:"Connect Gmail API",description:"Connect your Gmail account for seamless email sending.",emoji:"ðŸ“§",challenges:[]},{id:"email-templates-merge-fields",name:"Email Templates with Merge-Fields",description:"Create reusable email templates with dynamic personalization.",emoji:"ðŸ“",challenges:[]},{id:"schedule-campaign",name:"Schedule a Campaign",description:"Plan and schedule your email campaigns for optimal timing.",emoji:"ðŸ“†",challenges:[]},{id:"ai-each-unique-campaign",name:'Create AI "Each Unique" Campaign',description:"Launch an AI-powered campaign with unique emails for each contact.",emoji:"ðŸ¤–",challenges:[]}];function W(e){return J.find(t=>t.id===e)}function X(e){let t=J.findIndex(t=>t.id===e);if(t>=0&&t<J.length-1)return J[t+1]}function K(e){return J.find(t=>!e.includes(t.id)&&t.challenges.some(e=>e.steps.length>0))}e.s(["QUESTS",0,J,"getFirstIncompleteQuest",()=>K,"getNextQuest",()=>X,"getQuestById",()=>W],41826);var Z=e.i(84923);let ee={isRecording:!1,selectedQuestId:null,startRoute:null,steps:[],includeVideo:!1,videoBlob:null,videoStartTime:null,videoUploadId:null,videoUploadStatus:"idle"},et="fluffy-guidance-progress",ea={isActive:!1,currentQuestId:null,currentChallengeIndex:0,currentStepIndex:0,completedQuests:[],completedChallenges:{},isHeaderVisible:!1,playbackMode:"guide"};function es(){try{let e=localStorage.getItem(et);if(e)return{...ea,...JSON.parse(e)}}catch(e){console.error("Failed to load guidance progress:",e)}return ea}async function ei(){try{return await Z.queryClient.fetchQuery({queryKey:["/api/guidance/progress"],queryFn:(0,Z.getQueryFn)({on401:"returnNull"}),staleTime:3e4})}catch(e){return console.error("[GuidanceEngine] Failed to fetch server guidance progress:",e),null}}async function er(e){let t=localStorage.getItem("authToken"),a={completedQuests:e.completedQuests,completedChallenges:e.completedChallenges,currentQuestId:e.currentQuestId};try{let e={"Content-Type":"application/json"};t&&(e.Authorization=`Bearer ${t}`);let s=await fetch("/api/guidance/progress",{method:"PATCH",headers:e,credentials:"include",body:JSON.stringify(a)});if(!s.ok){let e=await s.text();console.error("[GuidanceEngine] Sync failed:",s.status,e)}}catch(e){console.error("[GuidanceEngine] Failed to sync guidance progress to server:",e)}}let eo="__test__";function en(e){let{authReady:t,userId:s}=e,[i,r]=(0,a.useState)(es),[o,n]=(0,a.useState)(!1),l=(0,a.useRef)(null),c=(0,a.useRef)(null),[u,p]=(0,a.useState)(null),m=(0,a.useRef)(null),[h,g]=(0,a.useState)(ee),x=(0,a.useRef)(!1),[f,y]=(0,a.useState)([]);(0,a.useEffect)(()=>{if(t)if("requestIdleCallback"in window){let t=requestIdleCallback(()=>e(),{timeout:2e3});return()=>cancelIdleCallback(t)}else{let t=setTimeout(()=>e(),100);return()=>clearTimeout(t)}async function e(){let e=await ei();e&&r(t=>({...t,completedQuests:e.completedQuests||t.completedQuests,completedChallenges:e.completedChallenges||t.completedChallenges,currentQuestId:e.currentQuestId??t.currentQuestId})),n(!0),c.current=s}},[t,s]),(0,a.useEffect)(()=>{t&&o&&c.current!==s&&(c.current=s,e());async function e(){let e=await ei();e&&r(t=>({...t,completedQuests:e.completedQuests||t.completedQuests,completedChallenges:e.completedChallenges||t.completedChallenges,currentQuestId:e.currentQuestId??t.currentQuestId}))}},[t,o,s]),(0,a.useEffect)(()=>{if(i.currentQuestId!==eo){try{let e={completedQuests:i.completedQuests,completedChallenges:i.completedChallenges,currentQuestId:i.currentQuestId};localStorage.setItem(et,JSON.stringify(e))}catch(e){console.error("Failed to save guidance progress:",e)}if(o&&t)return l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{er(i)},1e3),()=>{l.current&&clearTimeout(l.current)}}},[i,o,t,s]);let b=i.currentQuestId===eo,w=(0,a.useMemo)(()=>!i.currentQuestId||b?null:W(i.currentQuestId)||null,[i.currentQuestId,b]),v=(0,a.useMemo)(()=>b?u:w&&w.challenges[i.currentChallengeIndex]||null,[w,i.currentChallengeIndex,b,u]),j=(0,a.useMemo)(()=>v&&v.steps[i.currentStepIndex]||null,[v,i.currentStepIndex]),N=(0,a.useCallback)((e,t="guide")=>{let a=W(e);if(!a)return;let s=i.completedChallenges[e]||[],o=a.challenges.findIndex(e=>!s.includes(e.id)&&e.steps.length>0);if(o<0)return;let n="show"===t?-1:0;r(a=>({...a,isActive:!0,currentQuestId:e,currentChallengeIndex:o,currentStepIndex:n,isHeaderVisible:!0,playbackMode:t}))},[i.completedChallenges]),k=(0,a.useCallback)(()=>{if(!w){let e=K(i.completedQuests);e&&N(e.id);return}let e=i.completedChallenges[w.id]||[],t=w.challenges.findIndex((t,a)=>a>i.currentChallengeIndex&&t.steps.length>0&&!e.includes(t.id));t>=0?r(e=>({...e,isActive:!0,currentChallengeIndex:t,currentStepIndex:0,isHeaderVisible:!0})):r(e=>({...e,completedQuests:[...e.completedQuests,w.id],currentQuestId:null,currentChallengeIndex:0,currentStepIndex:0,isActive:!1}))},[w,i.currentChallengeIndex,i.completedQuests,i.completedChallenges,N]),C=(0,a.useCallback)(()=>{if(!v)return;let e=i.currentStepIndex+1;if(e<v.steps.length)r(t=>({...t,currentStepIndex:e}));else if("show"===i.playbackMode)r(e=>({...e,isActive:!1}));else{let e=i.currentQuestId;if(e){let t=i.completedChallenges[e]||[];r(a=>({...a,completedChallenges:{...a.completedChallenges,[e]:[...t,v.id]},isActive:!1}))}}},[v,i.currentStepIndex,i.currentQuestId,i.completedChallenges,i.playbackMode]),S=(0,a.useCallback)(()=>{i.currentStepIndex>0&&r(e=>({...e,currentStepIndex:e.currentStepIndex-1}))},[i.currentStepIndex]),A=(0,a.useCallback)(()=>{if(!v||!i.currentQuestId)return;let e=i.completedChallenges[i.currentQuestId]||[];r(t=>({...t,completedChallenges:{...t.completedChallenges,[i.currentQuestId]:[...e,v.id]},isActive:!1,currentStepIndex:0}))},[v,i.currentQuestId,i.completedChallenges]),I=(0,a.useCallback)(()=>{r(e=>({...e,isActive:!1}))},[]),E=(0,a.useCallback)(()=>{if(i.currentQuestId)r(e=>({...e,isActive:!0,isHeaderVisible:!0}));else{let e=K(i.completedQuests);e&&N(e.id)}},[i.currentQuestId,i.completedQuests,N]),T=(0,a.useCallback)(()=>{r(e=>({...e,isHeaderVisible:!e.isHeaderVisible}))},[]),P=(0,a.useCallback)(()=>{r(ea),localStorage.removeItem(et),er(ea)},[]),M=(0,a.useCallback)((e,t,a="guide")=>{let s=W(e);if(!s)return;let o=s.challenges[t];if(!o||0===o.steps.length)return;let n=(i.completedChallenges[e]||[]).filter(e=>e!==o.id),l="show"===a?-1:0;r(s=>({...s,isActive:!0,currentQuestId:e,currentChallengeIndex:t,currentStepIndex:l,isHeaderVisible:!0,playbackMode:a,completedChallenges:{...s.completedChallenges,[e]:n}}))},[i.completedChallenges]),L=(0,a.useCallback)(()=>w?{completed:(i.completedChallenges[w.id]||[]).length,total:w.challenges.length}:{completed:0,total:0},[w,i.completedChallenges]),Q=(0,a.useCallback)(()=>({completed:i.completedQuests.length,total:J.length}),[i.completedQuests]),R=(0,a.useCallback)((e,t,a="guide")=>{p(e),m.current=t||null,r(e=>({...e,isActive:!0,currentQuestId:eo,currentChallengeIndex:0,currentStepIndex:0,isHeaderVisible:!0,playbackMode:a}))},[]),$=(0,a.useCallback)(()=>{p(null),m.current=null,r(e=>({...e,isActive:!1,currentQuestId:null,currentChallengeIndex:0,currentStepIndex:0}))},[]);(0,a.useEffect)(()=>{if(!h.isRecording){x.current=!1;return}x.current=!0;let e=e=>{if(!x.current)return;let t=e.target;if(t.closest("[data-recorder-ui]"))return;let a=d(t),s={selector:a.selector,contentMatch:a.contentMatch,action:"click",tagName:t.tagName.toLowerCase(),textContent:function(e){let t=e.getAttribute("aria-label");if(t)return t;let a=e.textContent?.trim().slice(0,50);if(a)return a;if(e.getAttribute("placeholder"))return e.getAttribute("placeholder")||"";let s=e.getAttribute("title");return s||e.tagName.toLowerCase()}(t),route:window.location.pathname,timestamp:Date.now()};g(e=>({...e,steps:[...e.steps,s]}))},t=e=>{if(!x.current)return;let t=e.target;if(!t.tagName||!["INPUT","TEXTAREA"].includes(t.tagName)||t.closest("[data-recorder-ui]"))return;let a=d(t);g(e=>{let s=e.steps[e.steps.length-1];if(s&&s.selector===a.selector&&"type"===s.action){let a=[...e.steps];return a[a.length-1]={...s,typedValue:t.value},{...e,steps:a}}return{...e,steps:[...e.steps,{selector:a.selector,contentMatch:a.contentMatch,action:"type",tagName:t.tagName.toLowerCase(),textContent:t.placeholder||"input field",typedValue:t.value,route:window.location.pathname,timestamp:Date.now()}]}})};return document.addEventListener("click",e,!0),document.addEventListener("input",t,!0),()=>{document.removeEventListener("click",e,!0),document.removeEventListener("input",t,!0)}},[h.isRecording]);let D=(0,a.useCallback)((e,t,a=!1)=>{g({isRecording:!0,selectedQuestId:e,startRoute:t,steps:[],includeVideo:a,videoBlob:null,videoStartTime:a?Date.now():null,videoUploadId:null,videoUploadStatus:"idle"})},[]),q=(0,a.useCallback)(()=>{let e=h.steps;return g(e=>({...e,isRecording:!1})),e},[h.steps]),F=(0,a.useCallback)(()=>{g(ee)},[]),G=(0,a.useCallback)(e=>{g(t=>({...t,videoBlob:e}))},[]),z=(0,a.useCallback)((e,t)=>{g(a=>({...a,videoUploadStatus:e,videoUploadId:void 0!==t?t:a.videoUploadId}))},[]),Y=(0,a.useCallback)(e=>{r(t=>({...t,playbackMode:e}))},[]),O=(0,a.useCallback)(async e=>{},[]);return(0,a.useEffect)(()=>{if(b&&!i.isActive&&u){let e=m.current;p(null),m.current=null,r(e=>({...e,currentQuestId:null})),e&&setTimeout(e,100)}},[b,i.isActive,u]),{state:i,currentQuest:w,currentChallenge:v,currentStep:j,startQuest:N,startNextChallenge:k,advanceStep:C,previousStep:S,completeChallenge:A,pauseGuidance:I,resumeGuidance:E,toggleHeader:T,resetProgress:P,restartChallenge:M,getChallengeProgress:L,getQuestProgress:Q,startChallenge:R,stopChallenge:$,isTestMode:b,setPlaybackMode:Y,videoTimestamps:f,setVideoTimestamps:y,recording:h,startRecording:D,stopRecording:q,clearRecording:F,setVideoBlob:G,setVideoUploadStatus:z,refreshChallengeVideo:O}}e.s(["useGuidanceEngine",()=>en],26246);var el=e.i(94318),ec=e.i(22016),ed=e.i(20278);function eu({questName:e,challengesCompleted:s,totalChallenges:i,currentChallengeName:r,isVisible:o,onClose:n}){let l=s/i*100,[c,d]=(0,a.useState)(!1),u=(0,a.useRef)(null),p=(0,a.useRef)(!1),m=(0,a.useCallback)(()=>{u.current&&(clearTimeout(u.current),u.current=null)},[]),x=(0,a.useCallback)(e=>{m(),u.current=setTimeout(()=>{p.current||d(!1)},e)},[m]),f=(0,a.useCallback)(()=>{p.current=!0,m(),d(!0)},[m]),b=(0,a.useCallback)(()=>{p.current=!1,x(1500)},[x]),w=(0,a.useCallback)(()=>{c?(m(),d(!1)):(d(!0),x(2e3))},[c,x,m]);return(0,t.jsx)(g.AnimatePresence,{children:o&&(0,t.jsx)(h.motion.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 left-0 right-0 z-50 flex justify-center pointer-events-none","data-testid":"quest-progress-header","data-recorder-ui":"true",children:(0,t.jsx)(h.motion.div,{onMouseEnter:f,onMouseLeave:b,onClick:w,animate:{width:c?"100%":"auto"},transition:{duration:.25,ease:"easeInOut"},className:"pointer-events-auto bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 border-b border-yellow-500/30 shadow-lg cursor-pointer",style:{borderBottomLeftRadius:8*!c,borderBottomRightRadius:8*!c},children:(0,t.jsx)(g.AnimatePresence,{mode:"wait",children:c?(0,t.jsxs)(h.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"max-w-screen-xl mx-auto px-4 py-2 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 sm:gap-4",children:[(0,t.jsxs)(ec.default,{href:"/quests",className:"flex items-center gap-2 hover:opacity-80 transition-opacity cursor-pointer",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(N,{className:"h-4 w-4 text-yellow-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-yellow-400 hidden sm:inline",children:e})]}),(0,t.jsx)("div",{className:"h-4 w-px bg-gray-600"}),(0,t.jsxs)(ec.default,{href:"/quests",className:"flex items-center gap-2 min-w-0 flex-1 hover:opacity-80 transition-opacity cursor-pointer",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(ed.Target,{className:"h-4 w-4 text-gray-400 flex-shrink-0 hidden sm:block"}),(0,t.jsx)("span",{className:"text-xs text-gray-300 truncate",children:r||"Ready for next challenge"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-16 sm:w-32 h-2 bg-gray-700 rounded-full overflow-hidden",children:(0,t.jsx)(h.motion.div,{className:"h-full bg-gradient-to-r from-yellow-500 to-amber-400 rounded-full",initial:{width:0},animate:{width:`${l}%`},transition:{duration:.5,ease:"easeOut"}})}),(0,t.jsxs)("span",{className:"text-xs text-gray-400",children:[s,"/",i]})]}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),n()},className:"text-gray-400 hover:text-white transition-colors p-1","data-testid":"close-quest-header",children:(0,t.jsx)(y.X,{className:"h-4 w-4"})})]})]},"expanded"):(0,t.jsxs)(h.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"px-3 py-1.5 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-24 h-2 bg-gray-700 rounded-full overflow-hidden",children:(0,t.jsx)(h.motion.div,{className:"h-full bg-gradient-to-r from-yellow-500 to-amber-400 rounded-full",initial:{width:0},animate:{width:`${l}%`},transition:{duration:.5,ease:"easeOut"}})}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),n()},className:"text-gray-500 hover:text-white transition-colors","data-testid":"close-quest-header-compressed",children:(0,t.jsx)(y.X,{className:"h-3.5 w-3.5"})})]},"compressed")})})})})}var ep=e.i(75822);e.i(67073);var em=e.i(31648),eh=e.i(27368),eg=e.i(91300);function ex({isVisible:e,challengeName:i,message:r,creditsAwarded:o,onContinue:n,onDismiss:l}){let c=(0,a.useRef)(null),[d,u]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(e&&((0,em.fireTouchConfetti)(),o&&o>0)){let e=setTimeout(()=>{(0,eh.animateCreditSparkles)(c.current)},800);return()=>clearTimeout(e)}},[e,o]),(0,s.createPortal)((0,t.jsx)(g.AnimatePresence,{children:e&&(0,t.jsx)(h.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[10000] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:l,"data-recorder-ui":"true",children:(0,t.jsxs)(h.motion.div,{initial:{scale:.5,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},exit:{scale:.5,opacity:0,y:50},transition:{type:"spring",stiffness:300,damping:25},className:"bg-gradient-to-br from-gray-900 to-gray-800 rounded-2xl p-8 max-w-md mx-4 text-center border border-yellow-500/30 shadow-2xl",onClick:e=>e.stopPropagation(),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[(0,t.jsx)(h.motion.div,{initial:{scale:0},animate:{scale:[0,1.2,1]},transition:{delay:.2,duration:.5},className:"w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-yellow-400 to-amber-500 flex items-center justify-center shadow-lg",children:(0,t.jsx)(N,{className:"h-10 w-10 text-white"})}),(0,t.jsx)(h.motion.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-2xl font-bold text-white mb-2",children:"Challenge Complete!"}),(0,t.jsx)(h.motion.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-yellow-400 font-medium mb-3",children:i}),r&&(0,t.jsx)(h.motion.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-gray-300 text-sm mb-4",children:r}),o&&o>0&&(0,t.jsxs)(h.motion.div,{ref:c,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.55,type:"spring",stiffness:400,damping:20},className:"flex items-center justify-center gap-2 bg-gradient-to-r from-amber-500/20 to-yellow-500/20 border border-amber-500/30 rounded-full px-4 py-2 mb-6","data-testid":"credits-badge",children:[(0,t.jsx)(ep.Coins,{className:"h-5 w-5 text-amber-400"}),(0,t.jsxs)("span",{className:"text-amber-400 font-semibold",children:["+",o," Credits Earned!"]})]}),(0,t.jsxs)(h.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"flex gap-3 justify-center",children:[(0,t.jsx)(Y.Button,{variant:"ghost",onClick:l,className:"text-gray-400 hover:text-white",children:"Dismiss"}),(0,t.jsxs)(Y.Button,{onClick:n,className:"bg-gradient-to-r from-yellow-500 to-amber-500 text-white hover:from-yellow-600 hover:to-amber-600",children:["Next Challenge ",(0,t.jsx)(f.ChevronRight,{className:"h-4 w-4 ml-1"})]})]}),(0,t.jsx)(h.motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"mt-6",children:(0,t.jsx)(eg.AutoDismissBar,{duration:5e3,onComplete:l,isPaused:d,isVisible:e,showCountdown:!0,countdownLabel:"Closing in"})})]})})}),document.body)}let ef=(0,j.default)("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var ey=e.i(63209);function eb({stream:e,isRecording:s,error:i,onRetry:r,className:o}){let n=(0,a.useRef)(null),[l,c]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{n.current&&e&&(n.current.srcObject=e,c(!0))},[e]),i)?(0,t.jsxs)("div",{className:"relative w-[200px] h-[130px] rounded-lg overflow-hidden bg-gray-800 flex flex-col items-center justify-center p-2",children:[(0,t.jsx)(ey.AlertCircle,{className:"w-6 h-6 text-red-400 mb-2"}),(0,t.jsx)("p",{className:"text-xs text-gray-300 text-center mb-2",children:"Camera access denied"}),r&&(0,t.jsx)(Y.Button,{size:"sm",variant:"outline",onClick:r,className:"text-xs",children:"Retry"})]}):e?(0,t.jsxs)("div",{className:`relative rounded-lg overflow-hidden bg-black shadow-lg ${o||"w-[200px] h-[130px]"}`,children:[(0,t.jsx)("video",{ref:n,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover transform scale-x-[-1]"}),s&&(0,t.jsxs)("div",{className:"absolute top-2 left-2 flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500 animate-pulse"}),(0,t.jsx)("span",{className:"text-xs text-white font-medium",children:"REC"})]}),!l&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-800",children:(0,t.jsx)("div",{className:"w-6 h-6 border-2 border-amber-400 border-t-transparent rounded-full animate-spin"})})]}):(0,t.jsx)("div",{className:"relative w-[200px] h-[130px] rounded-lg overflow-hidden bg-gray-800 flex items-center justify-center",children:(0,t.jsx)(ef,{className:"w-8 h-8 text-gray-500"})})}let ew=(0,j.default)("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),ev=(0,j.default)("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);var ej=e.i(26336),eN=e.i(98361),ek=e.i(95242),eC=e.i(67240);function eS({videoUrl:e,isVisible:s,onClose:i,position:r="bottom-right",size:o="small",onTimeUpdate:n,onPlayStateChange:l,canAutoPlay:c=!0}){let d=(0,a.useRef)(null),u=(0,a.useRef)(null),[p,m]=(0,a.useState)(!1),[x,f]=(0,a.useState)(!1),[b,w]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),[N,C]=(0,a.useState)(!1),[S,A]=(0,a.useState)(!1),[I,E]=(0,a.useState)(!1),[T,P]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{e&&d.current&&(w(!1),j(!1),E(!1),A(!1),d.current.load())},[e]),(0,a.useEffect)(()=>{if(s&&d.current&&b&&!v&&c){let e=Date.now();console.log(`[TIMING ${e}] VideoPlayer AUTO-PLAY starting - canAutoPlay: ${c}, currentTime: ${d.current.currentTime}s`),d.current.play().catch(console.error),A(!0)}},[s,b,v,c]),e&&s)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{ref:u,className:"fixed inset-0 pointer-events-none z-40"}),(0,t.jsx)(g.AnimatePresence,{children:(0,t.jsx)(h.motion.div,{drag:!0,dragConstraints:u,dragElastic:.1,dragMomentum:!1,onDragStart:()=>C(!0),onDragEnd:()=>C(!1),initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:`fixed ${{"bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4","top-right":"top-4 right-4","top-left":"top-4 left-4"}[r]} z-50 ${N?"cursor-grabbing":"cursor-grab"}`,whileDrag:{scale:1.05},children:(0,t.jsxs)("div",{className:`relative ${{small:x?"w-14 h-20":"w-32 h-48",medium:x?"w-16 h-24":"w-44 h-64",large:x?"w-20 h-28":"w-56 h-80"}[o]} transition-all duration-300 ease-out`,onMouseEnter:()=>P(!0),onMouseLeave:()=>P(!1),children:[(0,t.jsx)("div",{className:"absolute inset-0 rounded-xl overflow-hidden shadow-2xl ring-2 ring-amber-400/30",children:v?(0,t.jsx)("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Video unavailable"})}):(0,t.jsx)("video",{ref:d,className:"w-full h-full object-cover",src:e,muted:p,playsInline:!0,onLoadedData:()=>w(!0),onError:()=>j(!0),onEnded:()=>{A(!1),E(!0)},onPlay:()=>{A(!0),l?.(!0)},onPause:()=>{A(!1),l?.(!1)},onTimeUpdate:e=>{let t=1e3*e.target.currentTime;n?.(t)}})}),!x&&!v&&(I||!S||T)&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),d.current&&(I?(d.current.currentTime=0,d.current.play().catch(console.error),E(!1),A(!0)):S?(d.current.pause(),A(!1)):(d.current.play().catch(console.error),A(!0)))},className:"w-12 h-12 rounded-full bg-black/50 hover:bg-black/70 flex items-center justify-center text-white transition-colors cursor-pointer pointer-events-auto",children:I?(0,t.jsx)(eC.RotateCcw,{className:"w-5 h-5"}):S?(0,t.jsx)(ek.Pause,{className:"w-5 h-5"}):(0,t.jsx)(k.Play,{className:"w-5 h-5 ml-0.5"})})}),!x&&(0,t.jsxs)("div",{className:"absolute -top-1 -right-1 flex gap-1",children:[(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),m(!p)},className:"w-6 h-6 rounded-full bg-gray-900/80 hover:bg-gray-800 flex items-center justify-center text-white transition-colors",children:p?(0,t.jsx)(ev,{className:"w-3 h-3"}):(0,t.jsx)(ew,{className:"w-3 h-3"})}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),f(!0)},className:"w-6 h-6 rounded-full bg-gray-900/80 hover:bg-gray-800 flex items-center justify-center text-white transition-colors",children:(0,t.jsx)(ej.Minimize2,{className:"w-3 h-3"})}),i&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),i()},className:"w-6 h-6 rounded-full bg-gray-900/80 hover:bg-red-600 flex items-center justify-center text-white transition-colors",children:(0,t.jsx)(y.X,{className:"w-3 h-3"})})]}),x&&(0,t.jsx)("button",{onClick:()=>f(!1),className:"absolute inset-0 rounded-xl bg-black/40 flex items-center justify-center text-white hover:bg-black/60 transition-colors",children:(0,t.jsx)(eN.Maximize2,{className:"w-4 h-4"})}),!x&&!v&&(0,t.jsx)("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2",children:(0,t.jsx)("div",{className:"px-2 py-0.5 bg-amber-500/90 rounded-full",children:(0,t.jsx)("span",{className:"text-[10px] font-medium text-gray-900",children:"Your guide"})})})]})})})]}):null}async function eA({videoBlob:e,challengeId:t,questId:a,timestamps:s=[]}){let i=new FormData;i.append("video",e,"recording.webm"),i.append("challengeId",t),i.append("questId",a),i.append("timestamps",JSON.stringify(s));let r=await fetch("/api/guidance/videos",{method:"POST",body:i,credentials:"include"});if(!r.ok)throw Error((await r.json().catch(()=>({message:"Upload failed"}))).message||"Failed to upload video");return r.json()}async function eI(e){let t=await fetch(`/api/guidance/videos/${e}`,{credentials:"include"});if(!t.ok)throw Error("Failed to get video status");return t.json()}async function eE(e){try{let t=await fetch(`/api/guidance/challenges/${e}/video`,{credentials:"include"});if(404===t.status)return null;if(!t.ok)throw Error("Failed to get challenge video");return t.json()}catch{return null}}let eT=(0,a.createContext)(null),eP={state:{isActive:!1,currentQuestId:null,currentChallengeIndex:0,currentStepIndex:0,completedQuests:[],completedChallenges:{},isHeaderVisible:!1,playbackMode:"guide"},currentQuest:null,currentChallenge:null,currentStep:null,startQuest:()=>{},startNextChallenge:()=>{},advanceStep:()=>{},previousStep:()=>{},completeChallenge:()=>{},pauseGuidance:()=>{},resumeGuidance:()=>{},toggleHeader:()=>{},resetProgress:()=>{},restartChallenge:()=>{},getChallengeProgress:()=>({completed:0,total:0}),getQuestProgress:()=>({completed:0,total:0}),startChallenge:()=>{},stopChallenge:()=>{},isTestMode:!1,setPlaybackMode:()=>{},videoTimestamps:[],setVideoTimestamps:()=>{},recording:{isRecording:!1,steps:[],selectedQuestId:null,startRoute:null,includeVideo:!1,videoBlob:null,videoStartTime:null,videoUploadId:null,videoUploadStatus:"idle"},startRecording:()=>{},stopRecording:()=>[],clearRecording:()=>{},setVideoBlob:()=>{},setVideoUploadStatus:()=>{},refreshChallengeVideo:async()=>{}};function eM(){return(0,a.useContext)(eT)??eP}let eL=["/app","/quests","/contacts","/campaigns","/replies","/account","/strategy"];function eQ(e){return`fluffy-quest-triggered-${e}`}function eR(e){return"true"===localStorage.getItem(eQ(e))}function e$(e){localStorage.setItem(eQ(e),"true")}function eD({children:e,autoStartForNewUsers:s=!0}){let i=(0,v.usePathname)(),r=(0,v.useRouter)(),{user:o,isLoading:n}=(0,el.useAuth)(),l=en({authReady:!n,userId:o?.id??null}),[c,d]=(0,a.useState)(!1),[m,h]=(0,a.useState)(""),[g,x]=(0,a.useState)(""),[f,y]=(0,a.useState)(0),[b,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),C=(0,a.useRef)(!1),S=(0,a.useRef)(null);(0,a.useRef)(null);let A=(0,a.useRef)(null),I=(0,a.useRef)(!1),[,E]=(0,a.useState)(0),[T,P]=(0,a.useState)(null),[M,L]=(0,a.useState)(!1),[Q,R]=(0,a.useState)(!1),[$,D]=(0,a.useState)(0),q=(0,a.useRef)(!1),F=(0,a.useRef)(!1),G=(0,a.useRef)(null),[z,Y]=(0,a.useState)(!1),[O,V]=(0,a.useState)(-1),B=(0,a.useRef)([]),U=(0,a.useRef)(!1),H=(0,a.useCallback)(()=>{B.current.forEach(e=>clearTimeout(e)),B.current=[],U.current=!1},[]),W=(0,a.useCallback)((e,t)=>{let a=setTimeout(e,Math.max(0,t));return B.current.push(a),a},[]),X=(0,a.useRef)(l.startQuest);X.current=l.startQuest;let K=(0,a.useRef)(l.advanceStep);K.current=l.advanceStep;let Z=(0,a.useRef)(l.pauseGuidance);Z.current=l.pauseGuidance;let ee=(0,a.useRef)(l.setVideoTimestamps);ee.current=l.setVideoTimestamps;let{state:et,currentQuest:ea,currentChallenge:es,currentStep:ei,getChallengeProgress:er,videoTimestamps:eo}=l,ec=eL.some(e=>i===e||i.startsWith(e+"/"));"/app"===i||i.startsWith("/app/"),(0,a.useEffect)(()=>{if(!et.isActive){S.current=null;return}let e="show"===et.playbackMode&&O>=0?O:et.currentStepIndex,t=es?.steps[e];if(!t?.route)return;let a=`${et.currentQuestId}-${et.currentChallengeIndex}-${e}`;if(S.current!==a){S.current=a;let s=t.route;i===s||i.startsWith(s+"/")||(console.log(`[ROUTE] Navigating to ${s} for step ${e}`),r.push(s))}},[et.isActive,et.playbackMode,es,ei,et.currentQuestId,et.currentChallengeIndex,et.currentStepIndex,O,i,r]);let ed=(0,a.useCallback)(async e=>{try{let t=await eE(e);t?.url&&(P(t.url),L(!0))}catch{}},[]);(0,a.useEffect)(()=>{if(!et.isActive||!es?.id){P(null),L(!1),ee.current([]);return}let e=!1,t=Date.now();return console.log(`[TIMING ${t}] Fetching video for challenge: ${es.id}`),eE(es.id).then(a=>{if(e)return;let s=Date.now();a?.url?(P(a.url),L(!0),a.timestamps&&Array.isArray(a.timestamps)?(console.log(`[TIMING ${s}] Timestamps LOADED (took ${s-t}ms): ${JSON.stringify(a.timestamps)}`),ee.current(a.timestamps)):console.log(`[TIMING ${s}] Video loaded but NO timestamps`)):(P(null),L(!1),ee.current([]))}).catch(()=>{e||(P(null),L(!1),ee.current([]))}),()=>{e=!0}},[et.isActive,es?.id]),(0,a.useEffect)(()=>{q.current=!1,F.current=!1,Y(!1),V(-1),H(),D(0),R(!1),G.current&&(clearTimeout(G.current),G.current=null)},[es?.id,H]),(0,a.useEffect)(()=>{et.isActive&&"show"===et.playbackMode||(F.current=!1,H(),Y(!1),V(-1),U.current=!1)},[et.isActive,et.playbackMode,H]);let ep=(0,a.useCallback)((e,t,a,s)=>{let i=Date.now();try{let s=u(t.selector,t.contentMatch);if(console.log(`[TIMELINE ${i}] Action for step ${e}: ${t.action}, selector: "${t.selector}", contentMatch: "${t.contentMatch||"none"}", found: ${!!s}`),!s)return void console.warn(`[TIMELINE ${i}] Element NOT found: ${t.selector}`);let r=e===a.length-1;switch(t.action){case"click":if(s instanceof HTMLElement){s.scrollIntoView({behavior:"smooth",block:"center"});let t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});s.dispatchEvent(t),console.log(`[TIMELINE ${Date.now()}] CLICK dispatched for step ${e}`)}break;case"type":if(s instanceof HTMLInputElement||s instanceof HTMLTextAreaElement){s.scrollIntoView({behavior:"smooth",block:"center"}),s.focus();let a=t.value||"",i=Object.getOwnPropertyDescriptor(s instanceof HTMLTextAreaElement?window.HTMLTextAreaElement.prototype:window.HTMLInputElement.prototype,"value")?.set;if(!i)return void console.error("[TIMELINE] Could not get native value setter");i.call(s,""),s.dispatchEvent(new Event("input",{bubbles:!0})),q.current=!0;let r=0,o="",n=setInterval(()=>{r<a.length?(o+=a[r],i.call(s,o),s.dispatchEvent(new Event("input",{bubbles:!0})),r++):(clearInterval(n),s.dispatchEvent(new Event("change",{bubbles:!0})),s.blur(),s.focus(),q.current=!1,console.log(`[TIMELINE ${Date.now()}] TYPE completed for step ${e}`))},200)}break;case"hover":s instanceof HTMLElement&&(s.scrollIntoView({behavior:"smooth",block:"center"}),s.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!0})));break;case"view":s instanceof HTMLElement&&s.scrollIntoView({behavior:"smooth",block:"center"})}r&&!F.current&&(F.current=!0,console.log(`[TIMELINE] Last step ${e} - scheduling completion`),G.current=setTimeout(()=>{console.log("[TIMELINE] Completing challenge"),K.current()},1500))}catch(e){console.error("[TIMELINE] Error performing action:",e)}},[]);(0,a.useEffect)(()=>{if(!et.isActive||"show"!==et.playbackMode||!es||U.current)return;let e=es.steps,t=eo.length>0;console.log(`[TIMELINE] Starting show mode - ${e.length} steps, hasTimestamps: ${t}`);let a=[],s=e=>200*(e.value||"").length;if(t)for(let t=0;t<e.length;t++){let i,r=eo.find(e=>e.stepIndex===t);if(!r)continue;let o=r.timestamp,n=Math.max(0,o-1200);i="type"===e[t].action?o+s(e[t]):o,a.push({stepIndex:t,showTime:n,actionTime:o,hideTime:i})}else{let t=0;for(let i=0;i<e.length;i++){let r,o=t,n=t+1200;"type"===e[i].action?t=(r=n+s(e[i]))+500:(r=n,t=n+3e3-1200),a.push({stepIndex:i,showTime:o,actionTime:n,hideTime:r})}}return console.log("[TIMELINE] Built timeline:",a),U.current=!0,a.forEach((t,s)=>{let i=e[t.stepIndex];W(()=>{console.log(`[TIMELINE] Showing highlight for step ${t.stepIndex}`),V(t.stepIndex),Y(!0)},t.showTime),W(()=>{console.log(`[TIMELINE] Advancing engine to step ${t.stepIndex} and executing action`),K.current(),ep(t.stepIndex,i,e,eo)},t.actionTime),s<a.length-1?W(()=>{console.log(`[TIMELINE] Hiding highlight for step ${t.stepIndex}`),Y(!1),V(-1)},t.hideTime):W(()=>{console.log(`[TIMELINE] Hiding highlight for last step ${t.stepIndex}`),Y(!1),V(-1)},t.hideTime+1500)}),()=>{H()}},[et.isActive,et.playbackMode,es,eo,W,H,ep]);let em="show"===et.playbackMode&&O>=0?es?.steps[O]??ei:ei;(0,a.useEffect)(()=>{if(!s||n||et.isActive||et.currentQuestId||b||C.current)return;let e=(e,t)=>{var a;let s=!1!==t.requiresAuth,r=!1!==t.once;if(s&&!o||r&&eR(e)||et.completedQuests.includes(e)||t.route&&!(i===(a=t.route)||i.startsWith(a+"/")))return!1;switch(t.type){case"newUser":return 0===et.completedQuests.length;case"firstVisit":case"route":return!0;default:return!1}};for(let t of J)for(let a of t.challenges)if(a.trigger&&"userEvent"!==a.trigger.type&&e(t.id,a.trigger)){let e=setTimeout(()=>{a.trigger?.type==="newUser"?(k({questId:t.id,challengeId:a.id}),j(!0)):(X.current(t.id),e$(t.id))},_(a.startDelay,"startDelay"));return()=>clearTimeout(e)}},[s,n,o,i,et.isActive,et.currentQuestId,et.completedQuests,b]),(0,a.useEffect)(()=>{if(!s||n)return;let e=[];for(let t of J)for(let a of t.challenges)a.trigger?.type==="userEvent"&&a.trigger.eventName&&e.push({quest:t,challenge:a});if(0===e.length)return;let t=t=>{let a=t.type;for(let{quest:t,challenge:s}of e){if(s.trigger?.eventName!==a)continue;let e=!1!==s.trigger.requiresAuth,i=!1!==s.trigger.once;if(!(e&&!o||i&&eR(t.id)||et.completedQuests.includes(t.id))&&!et.isActive&&!et.currentQuestId){X.current(t.id),e$(t.id);break}}},a=Array.from(new Set(e.map(e=>e.challenge.trigger.eventName)));return a.forEach(e=>window.addEventListener(e,t)),()=>{a.forEach(e=>window.removeEventListener(e,t))}},[s,n,o,et.isActive,et.currentQuestId,et.completedQuests]),(0,a.useEffect)(()=>{let e=e=>{let{questId:t,mode:a}=e.detail;t&&X.current(t,a||"guide")},t=e=>{let{questId:t,challengeIndex:a,mode:s}=e.detail;void 0!==t&&void 0!==a&&l.restartChallenge(t,a,s||"guide")},a=()=>{l.resumeGuidance()};return window.addEventListener("guidance:start-quest",e),window.addEventListener("guidance:restart-challenge",t),window.addEventListener("guidance:resume-guidance",a),()=>{window.removeEventListener("guidance:start-quest",e),window.removeEventListener("guidance:restart-challenge",t),window.removeEventListener("guidance:resume-guidance",a)}},[l]),(0,a.useEffect)(()=>{if(et.isActive&&0===et.currentStepIndex&&es?.setupEvent&&ei?.route&&i===ei.route){let e=setTimeout(()=>{window.dispatchEvent(new CustomEvent(es.setupEvent))},150);return()=>clearTimeout(e)}},[et.isActive,et.currentStepIndex,es,ei,i]),(0,a.useEffect)(()=>{ec&&et.isActive&&!et.isHeaderVisible&&!l.isTestMode&&l.pauseGuidance()},[ec,et.isActive,et.isHeaderVisible,l,l.isTestMode]),(0,a.useEffect)(()=>{I.current=!1,E(e=>e+1)},[et.currentQuestId,et.currentChallengeIndex,et.currentStepIndex]),(0,a.useEffect)(()=>{let e=ei?.selector,t=ei?.action,a=ei?.advanceDelay;if(!ec||!et.isActive||!e)return;A.current&&(clearTimeout(A.current),A.current=null);let s=null,i=e=>{let t;if(A.current)return;s=setTimeout(()=>{I.current=!0,E(e=>e+1)},t="type"===e?200*(ei?.value||"").length:0);let i=es&&et.currentStepIndex===es.steps.length-1;A.current=setTimeout(()=>{K.current()},t+_(a,"advanceDelay")+4e3*!!i)},r=!1,o=e=>{if(["button","a","input","select","textarea"].includes(e.tagName.toLowerCase()))return!0;let t=e.getAttribute("role");return!!("button"===t||"link"===t||"menuitem"===t||"tab"===t||e.isContentEditable||e.hasAttribute("onclick")||e.hasAttribute("tabindex"))},n=a=>{if("show"===et.playbackMode)return;let s=a.target,r=null;try{r=u(e,ei?.contentMatch)}catch{}if(r&&(r===s||r.contains(s))){"click"===t&&i("click");return}if(null===s.closest('[data-recorder-ui="true"]')&&null===s.closest('[data-testid="guidance-tooltip"]')&&null===s.closest('[data-testid="fluffy-guide"]')){for(let e of a.composedPath())if(e instanceof Element&&o(e))return void Z.current()}},l=a=>{if("show"===et.playbackMode||"type"!==t||r)return;let s=a.target,o=u(e,ei?.contentMatch);o&&(o===s||o.contains(s))&&(r=!0,i("type"))},c=e=>{"Escape"===e.key&&Z.current()};return document.addEventListener("click",n,!0),document.addEventListener("keydown",c),document.addEventListener("input",l,!0),()=>{document.removeEventListener("click",n,!0),document.removeEventListener("keydown",c),document.removeEventListener("input",l,!0),s&&(clearTimeout(s),s=null),A.current&&(clearTimeout(A.current),A.current=null)}},[ec,et.isActive,et.playbackMode,et.currentStepIndex,ei?.selector,ei?.action,ei?.advanceDelay,ei?.value,es]);let eh=(0,a.useRef)(JSON.parse(JSON.stringify(et.completedChallenges)));(0,a.useEffect)(()=>{if("show"===et.playbackMode){eh.current=JSON.parse(JSON.stringify(et.completedChallenges));return}if(!et.isActive&&es&&ea){let e=et.completedChallenges[ea.id]||[],t=eh.current[ea.id]||[];!e.includes(es.id)||t.includes(es.id)||c||(h(es.name),x(es.completionMessage||"Great job!"),y(es.completionCredits??110),d(!0))}eh.current=JSON.parse(JSON.stringify(et.completedChallenges))},[et.isActive,et.completedChallenges,es,ea,c,et.playbackMode]);let eg=(0,a.useCallback)(()=>{d(!1),l.pauseGuidance()},[l]),ef=(0,a.useCallback)(()=>{d(!1),l.startNextChallenge()},[l]),ey=(0,a.useCallback)(()=>{et.isActive?l.pauseGuidance():l.resumeGuidance()},[et.isActive,l]),eb=(0,a.useCallback)(()=>{l.pauseGuidance(),l.toggleHeader()},[l]),ew=(0,a.useCallback)(()=>{j(!1);let e=N?.questId??J[0].id;e$(e),X.current(e,"show"),k(null)},[N]),ev=(0,a.useCallback)(()=>{j(!1);let e=N?.questId??J[0].id;e$(e),X.current(e,"guide"),k(null)},[N]),ej=(0,a.useCallback)(()=>{j(!1),k(null),C.current=!0},[]),eN=er(),ek={...l,refreshChallengeVideo:ed};return(0,t.jsxs)(eT.Provider,{value:ek,children:[ec&&(0,t.jsx)(eu,{questName:ea?.name||"Quest",challengesCompleted:eN.completed,totalChallenges:eN.total,currentChallengeName:es?.name,isVisible:et.isHeaderVisible,onClose:eb}),e,ec&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eF,{onClick:ey,isActive:et.isActive,onCloseGuide:l.pauseGuidance,starterMode:b,onShowMeMode:ew,onGuideMeMode:ev,onStarterDismiss:ej}),(0,t.jsx)(eS,{videoUrl:T,isVisible:M&&et.isActive,onClose:()=>L(!1),position:"bottom-left",size:"small",onTimeUpdate:D,onPlayStateChange:R,canAutoPlay:"show"!==et.playbackMode||eo.length>0}),et.isActive&&em&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p,{targetSelector:em.selector,contentMatch:em.contentMatch,isVisible:et.isActive&&!I.current&&("show"!==et.playbackMode||z),actionType:em.action}),(0,t.jsx)(w,{targetSelector:em.selector,contentMatch:em.contentMatch,instruction:em.instruction,position:em.tooltipPosition||"auto",isVisible:et.isActive&&!I.current&&("show"!==et.playbackMode||z),onDismiss:()=>l.advanceStep(),onBack:()=>l.previousStep(),onClose:()=>l.pauseGuidance(),stepNumber:("show"===et.playbackMode?O:et.currentStepIndex)+1,totalSteps:es?.steps.length,playbackMode:et.playbackMode,hasVideo:!!T,onModeToggle:()=>{l.setPlaybackMode("guide"===et.playbackMode?"show":"guide")}})]}),(0,t.jsx)(ex,{isVisible:c,challengeName:m,message:g,creditsAwarded:f,onContinue:ef,onDismiss:eg})]})]})}function eq({isOpen:e,onClose:i}){let r=(0,v.usePathname)(),[o,n]=(0,a.useState)("idle"),[l,c]=(0,a.useState)(J[0]?.id||""),[d,u]=(0,a.useState)(null),[p,m]=(0,a.useState)(null),[x,f]=(0,a.useState)(!1),[b,w]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!1),[S,A]=(0,a.useState)(null),[I,H]=(0,a.useState)(!1),[_,W]=(0,a.useState)(!1),[X,K]=(0,a.useState)(null),[Z,ee]=(0,a.useState)(!1),[et,ea]=(0,a.useState)(0),es=eM(),{recording:ei,startRecording:er,stopRecording:eo,clearRecording:en,setVideoBlob:el,setVideoUploadStatus:ec,refreshChallengeVideo:ed}=es,[eu,ep]=(0,a.useState)(!1),em=function(e={}){let{mimeType:t="video/webm;codecs=vp9",videoBitsPerSecond:s=5e5}=e,[i,r]=(0,a.useState)(!1),[o,n]=(0,a.useState)(!1),[l,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[p,m]=(0,a.useState)(null),h=(0,a.useRef)(null),g=(0,a.useRef)(null),x=(0,a.useRef)([]),f=(0,a.useCallback)(async()=>{try{u(null);let e=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"},audio:!0});g.current=e,m(e),n(!0)}catch(e){throw u(e instanceof Error?e.message:"Failed to access camera"),e}},[]),y=(0,a.useCallback)(()=>{g.current&&(g.current.getTracks().forEach(e=>e.stop()),g.current=null),m(null),n(!1)},[]),b=(0,a.useCallback)(()=>{if(!g.current)return void u("No stream available");x.current=[],c(null);let e=new MediaRecorder(g.current,{mimeType:t,videoBitsPerSecond:s});e.ondataavailable=e=>{e.data.size>0&&x.current.push(e.data)},h.current=e,e.start(1e3),r(!0)},[t,s]);return{isRecording:i,isPreviewing:o,videoBlob:l,stream:p,startPreview:f,stopPreview:y,startRecording:b,stopRecording:(0,a.useCallback)(()=>new Promise((e,a)=>{let s=h.current;s&&"inactive"!==s.state?(s.onstop=()=>{let a=new Blob(x.current,{type:t});c(a),r(!1),e(a)},s.stop()):a(Error("No active recording"))}),[t]),getStream:(0,a.useCallback)(()=>g.current,[]),error:d}}();(0,a.useEffect)(()=>{ei.isRecording&&"recording"!==o&&!Z&&n("recording")},[ei.isRecording,o,Z]),(0,a.useEffect)(()=>{ei.selectedQuestId&&ei.selectedQuestId!==l&&c(ei.selectedQuestId)},[ei.selectedQuestId,l]);let eh=(0,a.useRef)(em.stopPreview);eh.current=em.stopPreview;let eg=(0,a.useRef)(em.getStream);eg.current=em.getStream,(0,a.useEffect)(()=>{e||(eg.current()&&eh.current(),ep(!1))},[e]);let ex=async()=>{l?(m(null),u(null),eu&&em.stream&&em.startRecording(),er(l,r,eu),n("recording")):m("Please select a quest before recording")},ef=(0,a.useRef)(!1);(0,a.useEffect)(()=>()=>{ef.current=!0},[]);let ey=async(e,t,a=30)=>{ef.current=!1;for(let s=0;s<a;s++){if(ef.current||(await new Promise(e=>setTimeout(e,2e3)),ef.current))return;try{let a=await eI(e);if(ef.current)return;if("completed"===a.status){ec("completed",e),ed(t);return}if("failed"===a.status)return void ec("failed",e)}catch(e){if(ef.current)return;console.error("Failed to poll video status:",e)}}ef.current||ec("failed",e)},ew=async()=>{let e=ei.videoStartTime,t=ei.selectedQuestId||l,a=ei.startRoute||r,s=null,i=em.getStream();if(eu&&i){try{s=await em.stopRecording(),el(s)}catch(e){console.error("Failed to stop video recording:",e)}em.stopPreview()}let o=eo();n("processing");try{let i=await fetch("/api/guidance/generate-challenge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({questId:t,startRoute:a,steps:o})});if(!i.ok)throw Error("Failed to generate challenge");let r=await i.json();if(u(r.challenge),n("complete"),s&&r.challenge?.id){ec("uploading");try{let a=o.map((t,a)=>({stepIndex:a,timestamp:t.timestamp-(e||o[0]?.timestamp||0),action:t.action})),i=await eA({videoBlob:s,challengeId:r.challenge.id,questId:t,timestamps:a});ec("processing",i.id),ey(i.id,r.challenge.id)}catch(e){console.error("Failed to upload video:",e),ec("failed")}}}catch(e){m(e instanceof Error?e.message:"Failed to generate challenge"),n("idle")}},ev=async()=>{if(d&&l){N(!0),A(null);try{let e=await fetch(`/api/guidance/quests/${l}/challenges`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({challenge:d})}),t=await e.json();e.ok?A({success:!0,message:t.message||"Challenge inserted successfully!"}):A({success:!1,message:t.message||"Failed to insert challenge"})}catch(e){A({success:!1,message:e instanceof Error?e.message:"Failed to insert challenge"})}finally{N(!1)}}},ej=()=>{X&&(u(X),W(!1),A(null))},eN=()=>{Z&&eo(),W(!1),K(null),ee(!1)},ek=(e,t)=>{X&&K({...X,[e]:t})},eC=(e,t,a)=>{if(!X)return;let s=[...X.steps];s[e]={...s[e],[t]:a},K({...X,steps:s})};if((0,a.useEffect)(()=>{if(Z&&ei.steps.length>et){let e=ei.steps[ei.steps.length-1],t={id:`step-${Date.now()}`,selector:e.selector,action:e.action,instruction:e.textContent||"Click here",tooltipPosition:"auto",route:e.route};X&&K({...X,steps:[...X.steps,t]}),eo(),ee(!1)}},[Z,ei.steps.length,et,X,eo]),(0,a.useEffect)(()=>{!e&&ei.isRecording&&(en(),n("idle"))},[e,ei.isRecording,en]),!e||I)return null;let eS=J.find(e=>e.id===l),eE=ei.steps;return(0,s.createPortal)((0,t.jsx)("div",{"data-recorder-ui":"true",children:(0,t.jsx)(g.AnimatePresence,{children:(0,t.jsxs)(h.motion.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},className:"fixed bottom-24 right-6 z-[9999] bg-gray-900 rounded-xl shadow-2xl border border-gray-700 w-80 overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-700 bg-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:`w-2 h-2 rounded-full ${"recording"===o?"bg-red-500 animate-pulse":"bg-gray-500"}`}),(0,t.jsx)("span",{className:"text-sm font-medium text-white",children:"Challenge Recorder"})]}),(0,t.jsx)("button",{onClick:()=>{en(),n("idle"),u(null),m(null),w(!1),A(null),ee(!1),i()},className:"text-gray-400 hover:text-white transition-colors","data-testid":"recorder-close",children:(0,t.jsx)(y.X,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"p-4 space-y-4",children:["idle"===o&&(0,t.jsxs)(t.Fragment,{children:[0===J.length?(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"No quests available."}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Add quests to the quests.ts file first."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Select Quest"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>w(!b),className:"w-full flex items-center justify-between px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white text-sm hover:border-gray-500 transition-colors","data-testid":"quest-selector",children:[(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:eS?.emoji}),(0,t.jsx)("span",{className:"truncate",children:eS?.name})]}),(0,t.jsx)(L.ChevronDown,{className:`h-4 w-4 transition-transform ${b?"rotate-180":""}`})]}),(0,t.jsx)(g.AnimatePresence,{children:b&&(0,t.jsx)(h.motion.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-gray-600 rounded-lg shadow-xl max-h-48 overflow-y-auto z-50",children:J.map(e=>(0,t.jsxs)("button",{onClick:()=>{c(e.id),w(!1)},className:`w-full flex items-center gap-2 px-3 py-2 text-left text-sm hover:bg-gray-700 transition-colors ${e.id===l?"bg-gray-700 text-amber-400":"text-white"}`,children:[(0,t.jsx)("span",{children:e.emoji}),(0,t.jsx)("span",{className:"truncate",children:e.name})]},e.id))})})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 py-2",children:[(0,t.jsx)(B.Checkbox,{id:"include-video",checked:eu,onCheckedChange:async e=>{let t=!0===e;if(ep(t),t)try{await em.startPreview()}catch(e){m("Failed to access camera. Please allow camera access."),ep(!1)}else em.stopPreview()}}),(0,t.jsxs)("label",{htmlFor:"include-video",className:"text-sm text-gray-300 flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)(z,{className:"h-4 w-4 text-amber-400"}),"Include video recording"]})]}),eu&&em.stream&&(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsx)(eb,{stream:em.stream,isRecording:!1,className:"w-full h-32 rounded-lg"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Use a solid green/blue background for best results"})]}),(0,t.jsxs)(Y.Button,{onClick:ex,disabled:!l,className:"w-full bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"start-recording",children:[(0,t.jsx)(C.Circle,{className:"h-4 w-4 mr-2 fill-current"}),"Start Recording"]})]}),p&&(0,t.jsx)("p",{className:"text-sm text-red-400",children:p})]}),"recording"===o&&(0,t.jsxs)(t.Fragment,{children:[ei.includeVideo&&em.stream&&(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsx)(eb,{stream:em.stream,isRecording:em.isRecording,className:"w-full h-24"})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Recording Steps"}),(0,t.jsxs)("span",{className:"text-xs text-amber-400 font-medium",children:[eE.length," steps"]})]}),(0,t.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-1",children:0===eE.length?(0,t.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Click elements to record steps..."}):eE.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-300 bg-gray-800 rounded px-2 py-1",children:[(0,t.jsx)("span",{className:"text-amber-400",children:e.action}),(0,t.jsx)("span",{className:"truncate",children:e.textContent||e.selector})]},a))})]}),(0,t.jsxs)(Y.Button,{onClick:ew,disabled:0===eE.length,className:"w-full bg-amber-600 hover:bg-amber-700 text-white","data-testid":"stop-recording",children:[(0,t.jsx)(E.Square,{className:"h-4 w-4 mr-2 fill-current"}),"Stop & Generate"]})]}),"processing"===o&&(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3 py-4",children:[(0,t.jsx)(T.Loader2,{className:"h-8 w-8 text-amber-400 animate-spin"}),(0,t.jsx)("p",{className:"text-sm text-gray-300",children:"Generating challenge with AI..."})]}),"complete"===o&&d&&!_&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(P.Check,{className:"h-4 w-4 text-green-400"}),(0,t.jsx)("span",{className:"text-sm font-medium text-white",children:"Challenge Generated!"})]}),(0,t.jsx)("button",{onClick:()=>{d&&(K(JSON.parse(JSON.stringify(d))),W(!0))},className:"text-gray-400 hover:text-amber-400 transition-colors","data-testid":"edit-challenge",children:(0,t.jsx)(R.Pencil,{className:"h-4 w-4"})})]}),(0,t.jsxs)("button",{onClick:e=>{if(e.stopPropagation(),e.preventDefault(),!d)return;let t={...d,id:`sandbox_${Date.now()}`};H(!0),es.startChallenge(t,()=>{H(!1)})},className:"w-full text-left bg-gray-800 rounded-lg p-3 space-y-2 hover:bg-gray-700 transition-colors cursor-pointer border border-transparent hover:border-amber-500/50 group","data-testid":"test-challenge-card",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-lg",children:d.emoji}),(0,t.jsx)("span",{className:"text-sm font-medium text-white",children:d.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-amber-400 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,t.jsx)(k.Play,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Test"})]})]}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:d.description}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[d.steps.length," steps"]})]})]}),S&&(0,t.jsx)("div",{className:`text-xs px-3 py-2 rounded-lg ${S.success?"bg-green-900/50 text-green-300":"bg-red-900/50 text-red-300"}`,children:S.message}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(Y.Button,{onClick:ev,disabled:j||S?.success,className:"w-full bg-green-600 hover:bg-green-700 text-white disabled:opacity-50","data-testid":"insert-challenge",children:[j?(0,t.jsx)(T.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):S?.success?(0,t.jsx)(P.Check,{className:"h-4 w-4 mr-2"}):(0,t.jsx)(Q.Upload,{className:"h-4 w-4 mr-2"}),j?"Inserting...":S?.success?"Inserted!":"Insert into Quest File"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(Y.Button,{onClick:()=>{if(!d)return;let e=JSON.stringify(d,null,2);navigator.clipboard.writeText(e),f(!0),setTimeout(()=>f(!1),2e3)},variant:"outline",className:"flex-1 border-gray-600 text-white hover:bg-gray-800","data-testid":"copy-challenge",children:[x?(0,t.jsx)(P.Check,{className:"h-4 w-4 mr-2"}):(0,t.jsx)(M.Copy,{className:"h-4 w-4 mr-2"}),x?"Copied!":"Copy"]}),(0,t.jsx)(Y.Button,{onClick:()=>{en(),n("idle"),u(null),m(null),A(null),W(!1),K(null),ee(!1)},className:"flex-1 bg-amber-600 hover:bg-amber-700 text-white","data-testid":"record-another",children:"Record Another"})]})]})]}),"complete"===o&&_&&X&&(0,t.jsxs)("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-white",children:"Edit Challenge"}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:eN,className:"text-gray-400 hover:text-white transition-colors p-1","data-testid":"cancel-edit",children:(0,t.jsx)(y.X,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:ej,className:"text-green-400 hover:text-green-300 transition-colors p-1","data-testid":"save-edit",children:(0,t.jsx)(F.Save,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("div",{className:"w-12",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:"Emoji"}),(0,t.jsx)(O.Input,{value:X.emoji,onChange:e=>ek("emoji",e.target.value),className:"bg-gray-800 border-gray-600 text-white text-center px-1","data-testid":"edit-emoji"})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:"Name"}),(0,t.jsx)(O.Input,{value:X.name,onChange:e=>ek("name",e.target.value),className:"bg-gray-800 border-gray-600 text-white","data-testid":"edit-name"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:"Description"}),(0,t.jsx)(V.Textarea,{value:X.description,onChange:e=>ek("description",e.target.value),className:"bg-gray-800 border-gray-600 text-white text-sm resize-none",rows:2,"data-testid":"edit-description"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:"Completion Message"}),(0,t.jsx)(V.Textarea,{value:X.completionMessage,onChange:e=>ek("completionMessage",e.target.value),className:"bg-gray-800 border-gray-600 text-white text-sm resize-none",rows:2,"data-testid":"edit-completion-message"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("label",{className:"text-xs text-gray-500 uppercase tracking-wide",children:["Steps (",X.steps.length,")"]}),(0,t.jsxs)("button",{onClick:()=>{ea(ei.steps.length),ee(!0),er(l,r)},disabled:Z,className:"flex items-center gap-1 text-xs text-amber-400 hover:text-amber-300 disabled:opacity-50 transition-colors","data-testid":"add-step-btn",children:[(0,t.jsx)(G.Plus,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Add Step"})]})]}),Z&&(0,t.jsxs)("div",{className:"bg-amber-900/30 border border-amber-500/50 rounded-lg p-3 text-center",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 text-amber-400",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),(0,t.jsx)("span",{className:"text-xs font-medium",children:"Click an element to add as a step..."})]}),(0,t.jsx)("button",{onClick:()=>{eo(),ee(!1)},className:"mt-2 text-xs text-gray-400 hover:text-white","data-testid":"cancel-add-step",children:"Cancel"})]}),X.steps.map((e,a)=>(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-2 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-xs text-amber-400 font-medium",children:["Step ",a+1]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("button",{onClick:()=>(e=>{if(!X||0===e)return;let t=[...X.steps];[t[e-1],t[e]]=[t[e],t[e-1]],K({...X,steps:t})})(a),disabled:0===a,className:"text-gray-400 hover:text-white disabled:opacity-30 p-0.5","data-testid":`step-up-${a}`,children:(0,t.jsx)($,{className:"h-3 w-3"})}),(0,t.jsx)("button",{onClick:()=>(e=>{if(!X||e===X.steps.length-1)return;let t=[...X.steps];[t[e],t[e+1]]=[t[e+1],t[e]],K({...X,steps:t})})(a),disabled:a===X.steps.length-1,className:"text-gray-400 hover:text-white disabled:opacity-30 p-0.5","data-testid":`step-down-${a}`,children:(0,t.jsx)(D,{className:"h-3 w-3"})}),(0,t.jsx)("button",{onClick:()=>(e=>{if(!X)return;let t=X.steps.filter((t,a)=>a!==e);K({...X,steps:t})})(a),className:"text-red-400 hover:text-red-300 p-0.5","data-testid":`step-delete-${a}`,children:(0,t.jsx)(q.Trash2,{className:"h-3 w-3"})})]})]}),(0,t.jsx)(V.Textarea,{value:e.instruction,onChange:e=>eC(a,"instruction",e.target.value),className:"bg-gray-700 border-gray-600 text-white text-xs resize-none",rows:2,placeholder:"Instruction...","data-testid":`step-instruction-${a}`}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)(U.Select,{value:e.tooltipPosition||"auto",onValueChange:e=>eC(a,"tooltipPosition",e),children:[(0,t.jsx)(U.SelectTrigger,{className:"bg-gray-700 border-gray-600 text-white text-xs h-7","data-testid":`step-position-${a}`,children:(0,t.jsx)(U.SelectValue,{placeholder:"Position"})}),(0,t.jsxs)(U.SelectContent,{className:"bg-gray-800 border-gray-600",children:[(0,t.jsx)(U.SelectItem,{value:"auto",className:"text-white text-xs",children:"Auto"}),(0,t.jsx)(U.SelectItem,{value:"top",className:"text-white text-xs",children:"Top"}),(0,t.jsx)(U.SelectItem,{value:"bottom",className:"text-white text-xs",children:"Bottom"}),(0,t.jsx)(U.SelectItem,{value:"left",className:"text-white text-xs",children:"Left"}),(0,t.jsx)(U.SelectItem,{value:"right",className:"text-white text-xs",children:"Right"})]})]})}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("span",{className:"text-[10px] text-gray-500 truncate block",children:e.selector})})]})]},e.id||a))]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,t.jsx)(Y.Button,{onClick:eN,variant:"outline",className:"flex-1 border-gray-600 text-white hover:bg-gray-800","data-testid":"cancel-edit-btn",children:"Cancel"}),(0,t.jsxs)(Y.Button,{onClick:ej,className:"flex-1 bg-green-600 hover:bg-green-700 text-white","data-testid":"save-edit-btn",children:[(0,t.jsx)(F.Save,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})]})]})})}),document.body)}function eF({onClick:e,isActive:i,onCloseGuide:r,starterMode:o=!1,onShowMeMode:n,onGuideMeMode:l,onStarterDismiss:c}){console.log("[FluffyGuide] render:",{isActive:i,starterMode:o});let d=(0,v.useRouter)(),[u,p]=(0,a.useState)(!1),[m,f]=(0,a.useState)(!1),[b,w]=(0,a.useState)(!1),[j,E]=(0,a.useState)(!1);(0,a.useEffect)(()=>{o&&(p(!0),E(!0))},[o]),(0,a.useEffect)(()=>{let e=setInterval(()=>{f(!0),setTimeout(()=>f(!1),1500)},18e4);return()=>clearInterval(e)},[]);let T=u||o;return(0,s.createPortal)((0,t.jsxs)("div",{"data-recorder-ui":"true",children:[!i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.AnimatePresence,{children:T&&(0,t.jsx)(h.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[9980]",onClick:()=>{o&&c?.(),p(!1),E(!1)}})}),(0,t.jsxs)(h.motion.div,{className:"fixed bottom-6 right-6 z-[9990]",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:15},children:[(0,t.jsx)(g.AnimatePresence,{children:T&&(0,t.jsx)(h.motion.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},className:"absolute bottom-full mb-3 right-0 bg-gray-900 rounded-xl shadow-2xl border border-gray-700 overflow-hidden min-w-[200px]",children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"px-4 py-3 border-b border-gray-700 flex items-center gap-2",children:[!o&&(0,t.jsx)("button",{onClick:()=>{E(!1)},className:"text-gray-400 hover:text-white transition-colors","data-testid":"fluffy-back-to-menu",children:(0,t.jsx)(x.ChevronLeft,{className:"h-4 w-4"})}),(0,t.jsx)("p",{className:"text-white text-sm font-medium",children:"Choose your tour style"})]}),(0,t.jsx)(I.TooltipProvider,{delayDuration:500,children:(0,t.jsxs)(I.Tooltip,{children:[(0,t.jsx)(I.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)("button",{onClick:()=>{p(!1),E(!1),n?.()},className:"w-full flex items-center gap-3 px-4 py-3 text-left text-white hover:bg-gray-800 transition-colors","data-testid":"fluffy-show-me",children:[(0,t.jsx)(k.Play,{className:"h-4 w-4 text-amber-400"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Show-me Mode"})]})}),(0,t.jsx)(I.TooltipContent,{side:"left",className:"bg-gray-900 text-white border-gray-700",children:(0,t.jsx)("p",{className:"text-xs",children:"Watch how it works"})})]})}),(0,t.jsx)(I.TooltipProvider,{delayDuration:500,children:(0,t.jsxs)(I.Tooltip,{children:[(0,t.jsx)(I.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)("button",{onClick:()=>{p(!1),E(!1),l?.()},className:"w-full flex items-center gap-3 px-4 py-3 text-left text-white hover:bg-gray-800 transition-colors border-t border-gray-700","data-testid":"fluffy-guide-me",children:[(0,t.jsx)(S,{className:"h-4 w-4 text-amber-400"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Guide-me Mode"})]})}),(0,t.jsx)(I.TooltipContent,{side:"left",className:"bg-gray-900 text-white border-gray-700",children:(0,t.jsx)("p",{className:"text-xs",children:"Try it yourself"})})]})}),(0,t.jsxs)("button",{onClick:()=>{p(!1),E(!1),c?.()},className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-400 hover:bg-gray-800 hover:text-white transition-colors border-t border-gray-700","data-testid":"fluffy-not-now",children:[(0,t.jsx)(y.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Not now"})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>{E(!0)},className:"w-full flex items-center gap-3 px-4 py-3 text-left text-white hover:bg-gray-800 transition-colors","data-testid":"fluffy-getting-started",children:[(0,t.jsx)(A.Sparkles,{className:"h-4 w-4 text-amber-400"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Getting Started"})]}),(0,t.jsxs)("button",{onClick:()=>{p(!1),e?.()},className:"w-full flex items-center gap-3 px-4 py-3 text-left text-white hover:bg-gray-800 transition-colors border-t border-gray-700","data-testid":"fluffy-start-quest",children:[(0,t.jsx)(k.Play,{className:"h-4 w-4 text-amber-400"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Start Quest"})]}),(0,t.jsxs)("button",{onClick:()=>{p(!1),d.push("/quests")},className:"w-full flex items-center gap-3 px-4 py-3 text-left text-white hover:bg-gray-800 transition-colors border-t border-gray-700","data-testid":"fluffy-view-quests",children:[(0,t.jsx)(N,{className:"h-4 w-4 text-amber-400"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"View All Quests"})]}),(0,t.jsxs)("button",{onClick:()=>{p(!1),w(!0)},className:"w-full flex items-center gap-3 px-4 py-3 text-left text-white hover:bg-gray-800 transition-colors border-t border-gray-700","data-testid":"fluffy-record-challenge",children:[(0,t.jsx)(C.Circle,{className:"h-4 w-4 text-red-400 fill-current"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Record Challenge"})]}),(0,t.jsx)(I.TooltipProvider,{children:(0,t.jsxs)(I.Tooltip,{children:[(0,t.jsx)(I.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)("button",{onClick:()=>{p(!1),r?.()},className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-400 hover:bg-gray-800 hover:text-white transition-colors border-t border-gray-700","data-testid":"fluffy-close-guide",children:[(0,t.jsx)(y.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Close Fluffy"})]})}),(0,t.jsx)(I.TooltipContent,{side:"left",className:"bg-gray-800 text-white border-gray-700",children:(0,t.jsx)("p",{children:"You can open this again from the quest page"})})]})})]})})}),(0,t.jsxs)("button",{onClick:()=>{i?e?.():p(!u)},className:`group transition-opacity duration-200 ${T?"opacity-100":"opacity-50 hover:opacity-100"}`,"data-testid":"fluffy-guide-button",children:[(0,t.jsx)(h.motion.div,{className:"relative w-10 h-10 rounded-full bg-gradient-to-br from-yellow-400 to-amber-500 flex items-center justify-center shadow-lg cursor-pointer",animate:{y:m&&!T?[0,-4,0,-2,0]:0,scale:1},transition:{y:{duration:1.2,ease:[.25,.1,.25,1]},scale:{duration:.2}},whileHover:{scale:1.1},whileTap:{scale:.95},children:(0,t.jsx)("span",{className:"text-xl",children:T?"ðŸ˜Š":"ðŸ¥"})}),(0,t.jsxs)(h.motion.div,{initial:{opacity:0,x:10},whileHover:{opacity:1,x:0},className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 bg-gray-800 text-white px-3 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg pointer-events-none",children:["Start Quest",(0,t.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-1 border-l-8 border-l-gray-800 border-y-4 border-y-transparent"})]})]})]})]}),(0,t.jsx)(eq,{isOpen:b,onClose:()=>w(!1)})]}),document.body)}var eG=e.i(70756),ez=e.i(71689),eY=e.i(86536),eO=e.i(54460),eV=e.i(42009);function eB({recipientName:e="Your Name",completionDate:a,isUnlocked:s}){let i=a||new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(0,t.jsxs)("div",{className:`
      relative w-full aspect-[1.4] rounded-lg overflow-hidden
      bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900
      border-2 ${s?"border-amber-500/50":"border-gray-700/50"}
      shadow-2xl
    `,children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-amber-900/20 via-transparent to-transparent"}),(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-amber-500 to-transparent"}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-amber-500 to-transparent"}),(0,t.jsx)("div",{className:"absolute top-0 left-0 w-1 h-full bg-gradient-to-b from-transparent via-amber-500 to-transparent"}),(0,t.jsx)("div",{className:"absolute top-0 right-0 w-1 h-full bg-gradient-to-b from-transparent via-amber-500 to-transparent"}),(0,t.jsx)("div",{className:"absolute top-3 left-3 w-8 h-8 border-t-2 border-l-2 border-amber-500/60 rounded-tl-lg"}),(0,t.jsx)("div",{className:"absolute top-3 right-3 w-8 h-8 border-t-2 border-r-2 border-amber-500/60 rounded-tr-lg"}),(0,t.jsx)("div",{className:"absolute bottom-3 left-3 w-8 h-8 border-b-2 border-l-2 border-amber-500/60 rounded-bl-lg"}),(0,t.jsx)("div",{className:"absolute bottom-3 right-3 w-8 h-8 border-b-2 border-r-2 border-amber-500/60 rounded-br-lg"}),(0,t.jsxs)("div",{className:"relative h-full flex flex-col items-center justify-center p-4 text-center",children:[(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsx)(eV.Award,{className:`h-6 w-6 ${s?"text-amber-400":"text-gray-500"}`})}),(0,t.jsx)("p",{className:`text-[6px] uppercase tracking-[0.15em] ${s?"text-amber-400/80":"text-gray-500"} mb-0.5`,children:"5Ducks GTM Mastery Program"}),(0,t.jsx)("h3",{className:"text-[9px] font-bold text-white mb-0.5",children:"Prospecting & Email Campaigns"}),(0,t.jsx)("p",{className:"text-[6px] text-gray-400 mb-1",children:"This certifies that"}),(0,t.jsx)("p",{className:`text-xs font-semibold ${s?"text-amber-300":"text-gray-400"} mb-2`,children:e}),(0,t.jsx)("p",{className:"text-[6px] text-gray-500",children:i}),!s&&(0,t.jsx)("div",{className:"absolute inset-0 bg-gray-900/60 backdrop-blur-[1px] flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(eG.Lock,{className:"h-5 w-5 text-gray-500 mx-auto mb-1"}),(0,t.jsx)("p",{className:"text-[8px] text-gray-400",children:"Complete all quests"})]})})]})]})}function eU({recipientName:e,completionDate:a,credentialId:s}){let i;return(0,t.jsxs)("div",{className:"relative w-full max-w-2xl mx-auto aspect-[1.4] rounded-xl overflow-hidden bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 border-2 border-amber-500/50 shadow-2xl",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-amber-900/30 via-transparent to-transparent"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_bottom_right,_var(--tw-gradient-stops))] from-amber-800/10 via-transparent to-transparent"}),(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-transparent via-amber-500 to-transparent"}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-2 bg-gradient-to-r from-transparent via-amber-500 to-transparent"}),(0,t.jsx)("div",{className:"absolute top-0 left-0 w-2 h-full bg-gradient-to-b from-transparent via-amber-500 to-transparent"}),(0,t.jsx)("div",{className:"absolute top-0 right-0 w-2 h-full bg-gradient-to-b from-transparent via-amber-500 to-transparent"}),(0,t.jsx)("div",{className:"absolute top-6 left-6 w-16 h-16 border-t-4 border-l-4 border-amber-500/60 rounded-tl-2xl"}),(0,t.jsx)("div",{className:"absolute top-6 right-6 w-16 h-16 border-t-4 border-r-4 border-amber-500/60 rounded-tr-2xl"}),(0,t.jsx)("div",{className:"absolute bottom-6 left-6 w-16 h-16 border-b-4 border-l-4 border-amber-500/60 rounded-bl-2xl"}),(0,t.jsx)("div",{className:"absolute bottom-6 right-6 w-16 h-16 border-b-4 border-r-4 border-amber-500/60 rounded-br-2xl"}),(0,t.jsxs)("div",{className:"relative h-full flex flex-col items-center justify-center p-8 md:p-12 text-center",children:[(0,t.jsx)(h.motion.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"mb-4",children:(0,t.jsx)("div",{className:"w-16 h-16 md:w-20 md:h-20 rounded-full bg-gradient-to-br from-amber-400 to-amber-600 flex items-center justify-center shadow-lg shadow-amber-500/30",children:(0,t.jsx)(eV.Award,{className:"h-8 w-8 md:h-10 md:w-10 text-gray-900"})})}),(0,t.jsx)(h.motion.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-xs md:text-sm uppercase tracking-[0.2em] text-amber-400/80 mb-1",children:"5Ducks GTM Mastery Program"}),(0,t.jsx)(h.motion.h2,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-xl md:text-3xl font-bold text-white mb-4",children:"Prospecting & Email Campaigns"}),(0,t.jsxs)(h.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"mb-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:"This certifies that"}),(0,t.jsx)("p",{className:"text-2xl md:text-4xl font-bold bg-gradient-to-r from-amber-300 via-amber-400 to-amber-300 bg-clip-text text-transparent",children:e})]}),(0,t.jsx)(h.motion.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},className:"text-xs md:text-sm text-gray-300 max-w-md mb-6",children:"has successfully completed all quests and demonstrated proficiency in B2B prospecting and email campaign management"}),(0,t.jsxs)(h.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},className:"flex flex-col items-center mt-2",children:[(0,t.jsx)("svg",{width:"120",height:"35",viewBox:"0 0 140 40",className:"-mb-1",style:{transform:"rotate(-2deg) skewX(-12deg)"},children:(0,t.jsx)("path",{d:"M6 34 C2 28, 0 18, 6 10 C12 2, 24 0, 30 8 C36 16, 32 28, 22 34 C12 40, 8 42, 18 38 C28 34, 34 26, 40 20 C46 14, 52 12, 56 16 C60 20, 58 26, 54 30 C50 34, 48 36, 54 34 C60 32, 68 26, 78 20 C88 14, 100 12, 110 18 C120 24, 116 32, 130 28",fill:"none",stroke:"#D1D5DB",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,t.jsx)("div",{className:"w-40 h-px bg-gray-600 mb-2"}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Director of GTM Programs"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:a})]}),(0,t.jsxs)(h.motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"absolute bottom-2 left-0 right-0 px-8 flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-[9px] text-gray-500",children:"Â© 5Ducks 2025, 10005 NY, USA"}),(0,t.jsx)("span",{className:"text-[8px] text-gray-600 font-mono",children:(i=(s||"0").padStart(6,"0"),`${i}-PE021`)})]})]})]})}var eH=e.i(40160),e_=e.i(84589);async function eJ(t,a,s){let i,{PDFDocument:r,rgb:o,StandardFonts:n}=await e.A(66151),l=await r.create(),c=l.addPage([842,595]),d=o(.05,.05,.08);c.drawRectangle({x:0,y:0,width:842,height:595,color:d});let u=o(.96,.72,.15),p=o(.99,.82,.4),m=o(.85,.65,.13),h=o(.6,.6,.65),g=o(.95,.95,.95);c.drawRectangle({x:1.5,y:1.5,width:839,height:592,borderColor:u,borderWidth:3,opacity:.5}),c.drawLine({start:{x:20,y:575},end:{x:20,y:535},thickness:4,color:u,opacity:.6}),c.drawLine({start:{x:20,y:575},end:{x:60,y:575},thickness:4,color:u,opacity:.6}),c.drawLine({start:{x:822,y:575},end:{x:822,y:535},thickness:4,color:u,opacity:.6}),c.drawLine({start:{x:822,y:575},end:{x:782,y:575},thickness:4,color:u,opacity:.6}),c.drawLine({start:{x:20,y:20},end:{x:20,y:60},thickness:4,color:u,opacity:.6}),c.drawLine({start:{x:20,y:20},end:{x:60,y:20},thickness:4,color:u,opacity:.6}),c.drawLine({start:{x:822,y:20},end:{x:822,y:60},thickness:4,color:u,opacity:.6}),c.drawLine({start:{x:822,y:20},end:{x:782,y:20},thickness:4,color:u,opacity:.6});let x=await l.embedFont(n.HelveticaBold),f=await l.embedFont(n.Helvetica),y=await l.embedFont(n.TimesRomanItalic);c.drawCircle({x:421,y:475,size:35,color:m}),c.drawCircle({x:421,y:475,size:28,color:u});let b="5DUCKS GTM MASTERY PROGRAM",w=f.widthOfTextAtSize(b,12);c.drawText(b,{x:(842-w)/2,y:420,size:12,font:f,color:p});let v="Prospecting & Email Campaigns",j=x.widthOfTextAtSize(v,28);c.drawText(v,{x:(842-j)/2,y:380,size:28,font:x,color:g});let N="This certifies that",k=f.widthOfTextAtSize(N,14);c.drawText(N,{x:(842-k)/2,y:315,size:14,font:f,color:h});let C=x.widthOfTextAtSize(t,40);c.drawText(t,{x:(842-C)/2,y:265,size:40,font:x,color:p});let S="has successfully completed all quests and demonstrated proficiency",A=f.widthOfTextAtSize(S,10);c.drawText(S,{x:(842-A)/2,y:220,size:10,font:f,color:h});let I="in B2B prospecting and email campaign management",E=f.widthOfTextAtSize(I,10);c.drawText(I,{x:(842-E)/2,y:203,size:10,font:f,color:h});let T=o(.15,.15,.15),P="Jm~rrsn",M=y.widthOfTextAtSize(P,24);c.drawText(P,{x:(842-M)/2,y:160,size:24,font:y,color:T});c.drawLine({start:{x:331,y:140},end:{x:511,y:140},thickness:1,color:h,opacity:.6});let L="Director of GTM Programs",Q=f.widthOfTextAtSize(L,10);c.drawText(L,{x:(842-Q)/2,y:125,size:10,font:f,color:h});let R=f.widthOfTextAtSize(a,10);c.drawText(a,{x:(842-R)/2,y:110,size:10,font:f,color:h}),c.drawText("Â© 5Ducks 2025, 10005 NY, USA",{x:30,y:12,size:7,font:f,color:h});let $=(i=(s||"0").padStart(6,"0"),`${i}-PE021`),D=f.widthOfTextAtSize($,7);return c.drawText($,{x:812-D,y:12,size:7,font:f,color:h}),l.save()}function eW({isOpen:e,onClose:s,recipientName:i,completionDate:r,isUnlocked:o,userId:n}){let[l,c]=(0,a.useState)(!1),d=async()=>{if(o){c(!0);try{let e=await eJ(i,r,n),t=new Blob([e],{type:"application/pdf"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`5Ducks-Certificate-${i.replace(/\s+/g,"-")}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}catch(e){console.error("Failed to generate certificate:",e)}finally{c(!1)}}};return(0,t.jsx)(e_.Dialog,{open:e,onOpenChange:e=>!e&&s(),children:(0,t.jsx)(e_.DialogContent,{className:"max-w-3xl bg-gray-950 border-gray-800 p-0 overflow-hidden",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{onClick:s,className:"absolute top-4 right-4 z-10 p-2 rounded-full bg-gray-800/80 hover:bg-gray-700 transition-colors","data-testid":"certificate-modal-close",children:(0,t.jsx)(y.X,{className:"h-5 w-5 text-gray-400"})}),(0,t.jsxs)("div",{className:"p-6 md:p-8",children:[(0,t.jsx)(eU,{recipientName:i,completionDate:r,credentialId:n}),(0,t.jsx)("div",{className:"mt-6 flex justify-center",children:(0,t.jsx)(Y.Button,{onClick:d,disabled:!o||l,className:`
                  ${o?"bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600":"bg-gray-700 cursor-not-allowed"} text-white px-6
                `,"data-testid":"certificate-download-button",children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating PDF..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eH.Download,{className:"h-4 w-4 mr-2"}),o?"Download Certificate":"Complete All Quests to Download"]})})}),!o&&(0,t.jsx)("p",{className:"text-center text-sm text-gray-500 mt-3",children:"This is a preview. Complete all quests to unlock your personalized certificate."})]})]})})})}function eX({recipientName:e,completionDate:s,isUnlocked:i,questsCompleted:r,totalQuests:o,userId:n}){let[l,c]=(0,a.useState)(!1),d=s||new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"mt-10 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(eV.Award,{className:"h-5 w-5 text-amber-400"}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Your Certificate"})]}),(0,t.jsx)("div",{className:`
          relative p-6 rounded-xl border backdrop-blur-sm
          ${i?"bg-gradient-to-br from-amber-900/20 to-orange-900/10 border-amber-500/30":"bg-gray-900/50 border-gray-700/50"}
        `,children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-6 items-center",children:[(0,t.jsxs)("button",{onClick:()=>c(!0),className:"group relative w-48 cursor-pointer","data-testid":"certificate-thumbnail",children:[(0,t.jsx)(eB,{recipientName:e,completionDate:d,isUnlocked:i}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-colors rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100",children:(0,t.jsxs)("div",{className:"bg-white/90 text-gray-900 px-3 py-1.5 rounded-full text-xs font-medium flex items-center gap-1.5",children:[(0,t.jsx)(eY.Eye,{className:"h-3.5 w-3.5"}),"Preview"]})})]}),(0,t.jsxs)("div",{className:"flex-1 text-center md:text-left",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"Prospecting & Email Campaigns Certificate"}),i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-gray-400 mb-4",children:"Congratulations! You've completed all quests and earned your certificate. Click the preview to view and download your personalized certificate."}),(0,t.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-green-500/20 text-green-400 rounded-full text-sm",children:[(0,t.jsx)("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Unlocked"]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-gray-400 mb-4",children:"Complete all quests to unlock your personalized certificate of completion. You can preview what it will look like by clicking the thumbnail."}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex-1 max-w-[200px] h-2 bg-gray-700 rounded-full overflow-hidden",children:(0,t.jsx)(h.motion.div,{initial:{width:0},animate:{width:`${r/o*100}%`},className:"h-full bg-amber-500 rounded-full"})}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:[r,"/",o," quests"]})]})]})]})]})})]}),(0,t.jsx)(eW,{isOpen:l,onClose:()=>c(!1),recipientName:e,completionDate:d,isUnlocked:i,userId:n})]})}function eK({quest:e,questIndex:s,status:i,completedChallenges:r,currentQuestId:o,currentChallengeIndex:n,isActive:l,onStartQuest:c,onContinueChallenge:d,onRestartChallenge:u,onStartLockedChallenge:p,onShowDemo:m}){let[x,f]=(0,a.useState)("in-progress"===i),[y,b]=(0,a.useState)(null),w=(r[e.id]||[]).length,v=e.challenges.length,j=w/v*100;return(0,t.jsxs)(h.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*s},className:`
        rounded-xl border backdrop-blur-sm overflow-hidden
        ${"completed"===i?"bg-gradient-to-br from-green-900/30 to-green-800/20 border-green-500/30":"in-progress"===i?"bg-gradient-to-br from-amber-900/30 to-amber-800/20 border-amber-500/30":"bg-gray-900/50 border-gray-700/50 opacity-60"}
      `,children:[(0,t.jsxs)("button",{onClick:()=>"locked"!==i&&f(!x),disabled:"locked"===i,className:"w-full p-5 flex items-center gap-4 text-left hover:bg-white/5 transition-colors disabled:cursor-not-allowed",children:[(0,t.jsx)("div",{className:`
          w-14 h-14 rounded-xl flex items-center justify-center text-2xl
          ${"completed"===i?"bg-green-500/20":"in-progress"===i?"bg-amber-500/20":"bg-gray-700/50"}
        `,children:"completed"===i?(0,t.jsx)(P.Check,{className:"h-7 w-7 text-green-400"}):"locked"===i?(0,t.jsx)(eG.Lock,{className:"h-6 w-6 text-gray-500"}):(0,t.jsx)("span",{children:e.emoji||"ðŸŽ¯"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsxs)("span",{className:"text-xs font-medium text-gray-400 uppercase tracking-wider",children:["Quest ",s+1]}),"completed"===i&&(0,t.jsx)("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded-full",children:"Complete"})]}),(0,t.jsx)("h3",{className:`text-lg font-semibold ${"locked"===i?"text-gray-500":"text-white"}`,children:e.name}),(0,t.jsx)("p",{className:`text-sm ${"locked"===i?"text-gray-600":"text-gray-400"} line-clamp-1`,children:e.description}),"locked"!==i&&(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex-1 h-2 bg-gray-700/50 rounded-full overflow-hidden",children:(0,t.jsx)(h.motion.div,{initial:{width:0},animate:{width:`${j}%`},transition:{duration:.5,ease:"easeOut"},className:`h-full rounded-full ${"completed"===i?"bg-green-500":"bg-amber-500"}`})}),(0,t.jsxs)("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:[w,"/",v]})]})]}),"locked"!==i&&(0,t.jsx)(h.motion.div,{animate:{rotate:180*!!x},transition:{duration:.2},children:(0,t.jsx)(L.ChevronDown,{className:"h-5 w-5 text-gray-400"})})]}),(0,t.jsx)(g.AnimatePresence,{children:x&&"locked"!==i&&(0,t.jsx)(h.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,t.jsx)("div",{className:"px-5 pb-5 space-y-2",children:e.challenges.map((a,s)=>{let g=function(e,t,a,s,i,r,o,n,l){if(0===e.steps.length)return"locked";let c=a[t]||[];return c.includes(e.id)?"completed":l&&s===t&&r===i?"in-progress":n.slice(0,r).every(e=>c.includes(e.id))&&"locked"!==o?"available":"locked"}(a,e.id,r,o,n,s,i,e.challenges,l),x=y===s,f=a.steps.length>0;return(0,t.jsxs)(h.motion.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*s},onMouseEnter:()=>b(s),onMouseLeave:()=>b(null),onClick:()=>{"completed"===g?u(e.id,s,a.name):"in-progress"===g?d(e.id,s):"available"===g?c(e.id):"locked"===g&&a.steps.length>0&&p(e.id,s)},className:`
                      flex items-center gap-3 p-3 rounded-lg
                      ${"completed"===g?"bg-green-500/10 cursor-pointer hover:bg-green-500/20":"in-progress"===g||"available"===g?"bg-amber-500/10 cursor-pointer hover:bg-amber-500/20":a.steps.length>0?"bg-gray-800/50 cursor-pointer hover:bg-gray-700/50":"bg-gray-800/50"}
                      transition-colors
                    `,children:[(0,t.jsx)("div",{className:`
                      w-8 h-8 rounded-lg flex items-center justify-center
                      ${"completed"===g?"bg-green-500/20":"in-progress"===g||"available"===g?"bg-amber-500/20":"bg-gray-700/50"}
                    `,children:"completed"===g?(0,t.jsx)(P.Check,{className:"h-4 w-4 text-green-400"}):"in-progress"===g||"available"===g?(0,t.jsx)(k.Play,{className:"h-4 w-4 text-amber-400"}):(0,t.jsx)(k.Play,{className:"h-4 w-4 text-gray-500"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h4",{className:`text-sm font-medium ${"locked"===g?"text-gray-500":"text-white"}`,children:a.name}),(0,t.jsx)("p",{className:`text-xs ${"locked"===g?"text-gray-600":"text-gray-400"} line-clamp-1`,children:a.description})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:0===a.steps.length?(0,t.jsx)("span",{className:"text-amber-500/70",children:"Coming Soon"}):`${a.steps.length} step${1!==a.steps.length?"s":""}`}),x&&f&&(0,t.jsxs)(Y.Button,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),m(e.id,s)},className:"border-amber-500/50 text-amber-400 hover:bg-amber-500/20 hover:text-amber-300 text-xs px-2 gap-1",children:[(0,t.jsx)(eY.Eye,{className:"h-3 w-3"}),"Show demo"]}),("in-progress"===g||"available"===g||x&&f&&"locked"===g)&&(0,t.jsx)(Y.Button,{size:"sm",onClick:t=>{t.stopPropagation(),"available"===g?c(e.id):"locked"===g?p(e.id,s):d(e.id,s)},className:"bg-amber-500 hover:bg-amber-600 text-white text-xs px-3",children:"in-progress"===g?"Continue":"Start Guide"})]},a.id)})})})})]})}function eZ(){let e=(0,v.useRouter)(),{state:s}=eM(),[i,r]=(0,a.useState)(null),o=(e,t,a)=>{r({questId:e,challengeIndex:t,challengeName:a})};(0,a.useEffect)(()=>{let e=document.documentElement,t=e.classList.contains("dark");return e.classList.add("dark"),()=>{t||e.classList.remove("dark")}},[]);let n=t=>{window.dispatchEvent(new CustomEvent("guidance:start-quest",{detail:{questId:t,mode:"guide"}})),e.push("/app")},l=(t,a)=>{s.currentQuestId===t?window.dispatchEvent(new CustomEvent("guidance:resume-guidance")):window.dispatchEvent(new CustomEvent("guidance:start-quest",{detail:{questId:t,mode:"guide"}})),e.push("/app")},c=(t,a)=>{window.dispatchEvent(new CustomEvent("guidance:restart-challenge",{detail:{questId:t,challengeIndex:a,mode:"guide"}})),e.push("/app")},d=(t,a)=>{window.dispatchEvent(new CustomEvent("guidance:restart-challenge",{detail:{questId:t,challengeIndex:a,mode:"show"}})),e.push("/app")},u=J.length,p=s.completedQuests.length,m=u>0?p/u*100:0;return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-gray-950 via-gray-900 to-gray-950",children:(0,t.jsxs)("div",{className:"max-w-3xl mx-auto px-4 py-8",children:[(0,t.jsxs)("button",{onClick:()=>e.push("/app"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-6",children:[(0,t.jsx)(ez.ArrowLeft,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Back to App"})]}),(0,t.jsxs)(h.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-10",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-2xl bg-gradient-to-br from-amber-500/20 to-orange-500/20 mb-4",children:(0,t.jsx)(N,{className:"h-10 w-10 text-amber-400"})}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Your Journey"}),(0,t.jsx)("p",{className:"text-gray-400 mb-6",children:"Complete quests to master the platform and unlock new abilities"}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-4 mb-2",children:[(0,t.jsx)("div",{className:"flex-1 max-w-xs h-3 bg-gray-800 rounded-full overflow-hidden",children:(0,t.jsx)(h.motion.div,{initial:{width:0},animate:{width:`${m}%`},transition:{duration:.8,ease:"easeOut"},className:"h-full bg-gradient-to-r from-amber-500 to-green-500 rounded-full"})}),(0,t.jsxs)("span",{className:"text-sm text-gray-400",children:[p,"/",u," Quests"]})]}),p===u&&u>0&&(0,t.jsx)(h.motion.div,{initial:{scale:0},animate:{scale:1},className:"mt-4",children:(0,t.jsxs)(Y.Button,{onClick:()=>{(0,em.fireCelebrateConfetti)()},className:"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600",children:[(0,t.jsx)(A.Sparkles,{className:"h-4 w-4 mr-2"}),"Celebrate!"]})})]}),(0,t.jsx)("div",{className:"space-y-4",children:J.map((e,a)=>{var i,r,u;let p=(i=s.completedQuests,r=s.currentQuestId,u=s.completedQuests.length,i.includes(e.id)?"completed":r===e.id||a<=u?"in-progress":"locked");return(0,t.jsx)(eK,{quest:e,questIndex:a,status:p,completedChallenges:s.completedChallenges,currentQuestId:s.currentQuestId,currentChallengeIndex:s.currentChallengeIndex,isActive:s.isActive,onStartQuest:n,onContinueChallenge:l,onRestartChallenge:o,onStartLockedChallenge:c,onShowDemo:d},e.id)})}),0===J.length&&(0,t.jsxs)(h.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-16",children:[(0,t.jsx)(ed.Target,{className:"h-16 w-16 text-gray-600 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-400 mb-2",children:"No Quests Available"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Check back soon for new challenges!"})]}),(0,t.jsx)(eX,{recipientName:"Your Name",isUnlocked:p===u&&u>0,questsCompleted:p,totalQuests:u,userId:"15"}),(0,t.jsx)(eO.AlertDialog,{open:!!i,onOpenChange:()=>r(null),children:(0,t.jsxs)(eO.AlertDialogContent,{className:"bg-gray-900 border-gray-700",children:[(0,t.jsxs)(eO.AlertDialogHeader,{children:[(0,t.jsx)(eO.AlertDialogTitle,{className:"text-white",children:"Restart Challenge?"}),(0,t.jsxs)(eO.AlertDialogDescription,{className:"text-gray-400",children:['Do you want to restart "',i?.challengeName,'"?']})]}),(0,t.jsxs)(eO.AlertDialogFooter,{children:[(0,t.jsx)(eO.AlertDialogCancel,{className:"bg-gray-800 text-white border-gray-700 hover:bg-gray-700",children:"Cancel"}),(0,t.jsx)(eO.AlertDialogAction,{onClick:()=>{i&&(window.dispatchEvent(new CustomEvent("guidance:restart-challenge",{detail:{questId:i.questId,challengeIndex:i.challengeIndex,mode:"guide"}})),r(null),e.push("/app"))},className:"bg-amber-500 hover:bg-amber-600",children:"Restart"})]})]})})]})})}e.s([],47655),e.s([],60835),e.i(60835),e.i(93421),e.i(90057),e.s(["CertificateFull",()=>eU,"CertificateModal",()=>eW,"CertificatePreview",()=>eB,"CertificateShowcase",()=>eX,"ChallengeComplete",()=>ex,"ChallengeRecorder",()=>eq,"ElementHighlight",()=>p,"FluffyGuide",()=>eF,"GuidanceTooltip",()=>w,"QuestProgressHeader",()=>eu,"QuestsPage",()=>eZ,"SpotlightOverlay",()=>m],78389),e.i(78389),e.i(26246),e.i(41826),e.s(["GUIDANCE_DEFAULTS",0,H,"QUESTS",0,J,"getFirstIncompleteQuest",()=>K,"getNextQuest",()=>X,"getQuestById",()=>W,"resolveDelay",()=>_],94973),e.i(94973),e.i(47655),e.s(["GuidanceProvider",()=>eD,"useGuidance",()=>eM],11590),e.i(11590),e.s(["CertificateFull",()=>eU,"CertificateModal",()=>eW,"CertificatePreview",()=>eB,"CertificateShowcase",()=>eX,"ChallengeComplete",()=>ex,"ChallengeRecorder",()=>eq,"ElementHighlight",()=>p,"FluffyGuide",()=>eF,"GUIDANCE_DEFAULTS",0,H,"GuidanceProvider",()=>eD,"GuidanceTooltip",()=>w,"QUESTS",0,J,"QuestProgressHeader",()=>eu,"QuestsPage",()=>eZ,"SpotlightOverlay",()=>m,"getFirstIncompleteQuest",()=>K,"getNextQuest",()=>X,"getQuestById",()=>W,"resolveDelay",()=>_,"useGuidance",()=>eM,"useGuidanceEngine",()=>en],20099)}]);